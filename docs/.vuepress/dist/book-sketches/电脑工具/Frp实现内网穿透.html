<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Frp实现内网穿透 | Liawn&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <meta charset="UTF-8">
  <link rel="icon" href="/blog-vuepress/favicon.ico">
    <meta name="description" content="用vuepress搭建的个人博客">
    <meta charset="UTF-8">
    
    <link rel="preload" href="/blog-vuepress/assets/css/0.styles.5c52d671.css" as="style"><link rel="preload" href="/blog-vuepress/assets/js/app.0d2e1fde.js" as="script"><link rel="preload" href="/blog-vuepress/assets/js/2.a046c74e.js" as="script"><link rel="preload" href="/blog-vuepress/assets/js/43.04bbcb6b.js" as="script"><link rel="prefetch" href="/blog-vuepress/assets/js/10.88d5532b.js"><link rel="prefetch" href="/blog-vuepress/assets/js/100.a282e1e5.js"><link rel="prefetch" href="/blog-vuepress/assets/js/101.1917817b.js"><link rel="prefetch" href="/blog-vuepress/assets/js/102.426bef2e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/103.24a96e53.js"><link rel="prefetch" href="/blog-vuepress/assets/js/104.0b4b8196.js"><link rel="prefetch" href="/blog-vuepress/assets/js/105.98db5522.js"><link rel="prefetch" href="/blog-vuepress/assets/js/106.7a39c799.js"><link rel="prefetch" href="/blog-vuepress/assets/js/11.78e26b31.js"><link rel="prefetch" href="/blog-vuepress/assets/js/12.e39a10a3.js"><link rel="prefetch" href="/blog-vuepress/assets/js/13.da0e53c1.js"><link rel="prefetch" href="/blog-vuepress/assets/js/14.91a6c713.js"><link rel="prefetch" href="/blog-vuepress/assets/js/15.b9f3c2f3.js"><link rel="prefetch" href="/blog-vuepress/assets/js/16.01c98a8e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/17.e733ec41.js"><link rel="prefetch" href="/blog-vuepress/assets/js/18.f4fea388.js"><link rel="prefetch" href="/blog-vuepress/assets/js/19.1d376bae.js"><link rel="prefetch" href="/blog-vuepress/assets/js/20.4751d85a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/21.00437d3b.js"><link rel="prefetch" href="/blog-vuepress/assets/js/22.64839502.js"><link rel="prefetch" href="/blog-vuepress/assets/js/23.7a4335d7.js"><link rel="prefetch" href="/blog-vuepress/assets/js/24.3ee2b263.js"><link rel="prefetch" href="/blog-vuepress/assets/js/25.0767dbc8.js"><link rel="prefetch" href="/blog-vuepress/assets/js/26.c416d882.js"><link rel="prefetch" href="/blog-vuepress/assets/js/27.5e82d924.js"><link rel="prefetch" href="/blog-vuepress/assets/js/28.24de79c4.js"><link rel="prefetch" href="/blog-vuepress/assets/js/29.5a1e4f8e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/3.0b0dd8a7.js"><link rel="prefetch" href="/blog-vuepress/assets/js/30.3c71597f.js"><link rel="prefetch" href="/blog-vuepress/assets/js/31.f5f5fe9d.js"><link rel="prefetch" href="/blog-vuepress/assets/js/32.eac572f0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/33.660b2af0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/34.b6f9bd89.js"><link rel="prefetch" href="/blog-vuepress/assets/js/35.2e5e8650.js"><link rel="prefetch" href="/blog-vuepress/assets/js/36.04d6e910.js"><link rel="prefetch" href="/blog-vuepress/assets/js/37.4ffc07ec.js"><link rel="prefetch" href="/blog-vuepress/assets/js/38.f31deb49.js"><link rel="prefetch" href="/blog-vuepress/assets/js/39.5bd11cdb.js"><link rel="prefetch" href="/blog-vuepress/assets/js/4.6edbb2a1.js"><link rel="prefetch" href="/blog-vuepress/assets/js/40.c0dc0955.js"><link rel="prefetch" href="/blog-vuepress/assets/js/41.32840955.js"><link rel="prefetch" href="/blog-vuepress/assets/js/42.afdf16b6.js"><link rel="prefetch" href="/blog-vuepress/assets/js/44.3f372036.js"><link rel="prefetch" href="/blog-vuepress/assets/js/45.199528f2.js"><link rel="prefetch" href="/blog-vuepress/assets/js/46.c23ffbe2.js"><link rel="prefetch" href="/blog-vuepress/assets/js/47.33bc80d6.js"><link rel="prefetch" href="/blog-vuepress/assets/js/48.c17f8a84.js"><link rel="prefetch" href="/blog-vuepress/assets/js/49.9f6c2490.js"><link rel="prefetch" href="/blog-vuepress/assets/js/5.c6c641ea.js"><link rel="prefetch" href="/blog-vuepress/assets/js/50.d6762688.js"><link rel="prefetch" href="/blog-vuepress/assets/js/51.1b65f46c.js"><link rel="prefetch" href="/blog-vuepress/assets/js/52.d00b4d17.js"><link rel="prefetch" href="/blog-vuepress/assets/js/53.becdeb67.js"><link rel="prefetch" href="/blog-vuepress/assets/js/54.fe84cbfc.js"><link rel="prefetch" href="/blog-vuepress/assets/js/55.42ca78e9.js"><link rel="prefetch" href="/blog-vuepress/assets/js/56.38dc1cb5.js"><link rel="prefetch" href="/blog-vuepress/assets/js/57.f4964e37.js"><link rel="prefetch" href="/blog-vuepress/assets/js/58.9b4d0044.js"><link rel="prefetch" href="/blog-vuepress/assets/js/59.cfb9c546.js"><link rel="prefetch" href="/blog-vuepress/assets/js/6.c6de6921.js"><link rel="prefetch" href="/blog-vuepress/assets/js/60.4f4f3658.js"><link rel="prefetch" href="/blog-vuepress/assets/js/61.e691fcda.js"><link rel="prefetch" href="/blog-vuepress/assets/js/62.fd6c77be.js"><link rel="prefetch" href="/blog-vuepress/assets/js/63.9acec8fc.js"><link rel="prefetch" href="/blog-vuepress/assets/js/64.c6c33b9e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/65.30e05c43.js"><link rel="prefetch" href="/blog-vuepress/assets/js/66.fdb85611.js"><link rel="prefetch" href="/blog-vuepress/assets/js/67.4a8c9b0e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/68.cf4c210b.js"><link rel="prefetch" href="/blog-vuepress/assets/js/69.b27adaff.js"><link rel="prefetch" href="/blog-vuepress/assets/js/7.4196f4e6.js"><link rel="prefetch" href="/blog-vuepress/assets/js/70.a3316969.js"><link rel="prefetch" href="/blog-vuepress/assets/js/71.9eb46133.js"><link rel="prefetch" href="/blog-vuepress/assets/js/72.0fe4fe9a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/73.0bf36b4a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/74.fc2e628a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/75.205b56bf.js"><link rel="prefetch" href="/blog-vuepress/assets/js/76.8c2bf9b9.js"><link rel="prefetch" href="/blog-vuepress/assets/js/77.a0993252.js"><link rel="prefetch" href="/blog-vuepress/assets/js/78.41709f17.js"><link rel="prefetch" href="/blog-vuepress/assets/js/79.c8733b25.js"><link rel="prefetch" href="/blog-vuepress/assets/js/8.f87272cd.js"><link rel="prefetch" href="/blog-vuepress/assets/js/80.f5ed5113.js"><link rel="prefetch" href="/blog-vuepress/assets/js/81.ddb61980.js"><link rel="prefetch" href="/blog-vuepress/assets/js/82.1d3482a9.js"><link rel="prefetch" href="/blog-vuepress/assets/js/83.a28d44e2.js"><link rel="prefetch" href="/blog-vuepress/assets/js/84.ce75ed5e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/85.d4ffd27c.js"><link rel="prefetch" href="/blog-vuepress/assets/js/86.14ffaf35.js"><link rel="prefetch" href="/blog-vuepress/assets/js/87.482be605.js"><link rel="prefetch" href="/blog-vuepress/assets/js/88.c1035bd5.js"><link rel="prefetch" href="/blog-vuepress/assets/js/89.e739598f.js"><link rel="prefetch" href="/blog-vuepress/assets/js/9.0f96b506.js"><link rel="prefetch" href="/blog-vuepress/assets/js/90.5a928d71.js"><link rel="prefetch" href="/blog-vuepress/assets/js/91.82d05736.js"><link rel="prefetch" href="/blog-vuepress/assets/js/92.8c0f11ee.js"><link rel="prefetch" href="/blog-vuepress/assets/js/93.5cff49c0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/94.8ad61574.js"><link rel="prefetch" href="/blog-vuepress/assets/js/95.f849a0b0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/96.31401883.js"><link rel="prefetch" href="/blog-vuepress/assets/js/97.98310d37.js"><link rel="prefetch" href="/blog-vuepress/assets/js/98.f626e78b.js"><link rel="prefetch" href="/blog-vuepress/assets/js/99.6891a17b.js">
    <link rel="stylesheet" href="/blog-vuepress/assets/css/0.styles.5c52d671.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><a href="/blog-vuepress/" class="home-link router-link-active"><!----> <span class="site-name">Liawn's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog-vuepress/book-web/" class="nav-link">
  Web
</a></div><div class="nav-item"><a href="/blog-vuepress/book-sketches/" class="nav-link router-link-active">
  生活
</a></div> <!----></nav></div></header> <div class="sidebar-wrapper sidebar-hidden"><aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog-vuepress/book-web/" class="nav-link">
  Web
</a></div><div class="nav-item"><a href="/blog-vuepress/book-sketches/" class="nav-link router-link-active">
  生活
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><!----> <span>电脑工具</span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog-vuepress/book-sketches/电脑工具/win10下载与安装.html" class="sidebar-link">win10下载与安装</a></li><li><a href="/blog-vuepress/book-sketches/电脑工具/谷歌浏览器使用.html" class="sidebar-link">谷歌浏览器使用</a></li><li><a href="/blog-vuepress/book-sketches/电脑工具/Frp实现内网穿透.html" class="active sidebar-link">Frp实现内网穿透</a></li><li><a href="/blog-vuepress/book-sketches/电脑工具/SoftEther实现虚拟局域网.html" class="sidebar-link">SoftEther实现虚拟局域网</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span>日常生活</span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog-vuepress/book-sketches/日常生活/土味情话.html" class="sidebar-link">土味情话</a></li></ul></section></li></ul> </aside> <div class="sidebar-toggle" data-v-10bfdc0c><div class="sidebar-toggle-button" data-v-10bfdc0c><span data-v-10bfdc0c></span><span data-v-10bfdc0c></span><span data-v-10bfdc0c></span></div></div></div> <main class="page sidebar-hidden right-sidebar-hidden"> <div class="theme-default-content content__default"><h1 id="frp实现内网穿透"><a href="#frp实现内网穿透" class="header-anchor">#</a> Frp实现内网穿透</h1> <h2 id="云服务器"><a href="#云服务器" class="header-anchor">#</a> 云服务器</h2> <p>暂时使用的是<a href="https://www.aliyun.com/" target="_blank" rel="noopener noreferrer">阿里云<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的<a href="https://www.aliyun.com/product/ecs" target="_blank" rel="noopener noreferrer">云服务器ECS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，轻量应用服务器、ECS通用型、ECS共享型都可以。</p> <p><a href="https://bandwagonhost.com/" target="_blank" rel="noopener noreferrer">搬瓦工<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://www.vultr.com/" target="_blank" rel="noopener noreferrer">vultr<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>也可以。</p> <h2 id="使用frp"><a href="#使用frp" class="header-anchor">#</a> 使用frp</h2> <h3 id="下载frp到服务端"><a href="#下载frp到服务端" class="header-anchor">#</a> 下载frp到服务端</h3> <p>在阿里云的<a href="https://ecs.console.aliyun.com/" target="_blank" rel="noopener noreferrer">云服务器ECS控制台<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>里，我们点击云服务器的<strong>远程连接</strong>，进入服务端控制台。</p> <p>输入<code>cd /usr/local</code>进入个人默认的程序安装路径，输入<code>arch</code>查看处理器的架构，根据这个架构去<a href="https://github.com/fatedier/frp/releases" target="_blank" rel="noopener noreferrer">frp的GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>里选择合适的版本。</p> <p>由于是<code>x86_64</code>所以我们选择amd64版本，输入<code>wget https://github.com/fatedier/frp/releases/download/v0.35.0/frp_0.35.0_linux_amd64.tar.gz</code>将frp下载到服务端。如果<code>/usr/local</code>里已经有了frp，是可以输入<code>rm -rf frp</code>进行删除的。</p> <p>输入<code>tar -zxvf frp_0.35.0_linux_amd64.tar.gz</code>对frp的压缩包进行解压，输入<code>rm frp_0.35.0_linux_amd64.tar.gz</code>对压缩包进行删除（输入<code>yes</code>确认删除），输入<code>mv frp_0.35.0_linux_amd64 frp</code>对解压出来的文件夹进行重命名。</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>cd /usr/local
wget https://github.com/fatedier/frp/releases/download/v0.35.0/frp_0.35.0_linux_amd64.tar.gz
tar -zxvf frp_0.35.0_linux_amd64.tar.gz
rm frp_0.35.0_linux_amd64.tar.gz
mv frp_0.35.0_linux_amd64 frp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="配置服务端里的frp"><a href="#配置服务端里的frp" class="header-anchor">#</a> 配置服务端里的frp</h3> <p>输入<code>cd frp</code>进入服务端的frp，输入<code>rm frpc</code>、<code>rm frpc.ini</code>和<code>rm frpc_full.ini</code>是为了删除客户端的东西，在服务端是用不着的。</p> <p>要配置一下frps.ini。输入<code>vim frps.ini</code>，再输入<code>i</code>进入输入模式，输入以下内容：</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>[common]
bind_port = 7000
token = 88888888
dashboard_port = 7500
dashboard_user = admin
dashboard_pwd = admin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>按Esc退出输入模式，输入<code>:wq</code>退出并保存。上面的<code>bind_port</code>是frp监听端口，<code>dashboard_port</code>是控制页面对应端口，<code>token</code>是服务端与客户端通信的令牌，<code>dashboard_user</code>是进入控制页面的账户，<code>dashboard_pwd</code>是进入控制页面账户对应的密码。<code>dashboard_xxx</code>不是特别重要，最重要的是<code>bind_port</code>和<code>token</code>。</p> <p>我们要让frp在服务端开机自运行。输入<code>vim /etc/systemd/system/frps.service</code>，再输入<code>i</code>进入输入模式，输入以下内容：</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>[Unit]
Description=frps daemon
After=syslog.target  network.target
Wants=network.target

[Service]
Type=simple
ExecStart=/usr/local/frp/frps -c /usr/local/frp/frps.ini
Restart=always
RestartSec=1min

[Install]
WantedBy=multi-user.target
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>按Esc退出输入模式，输入<code>:wq</code>退出并保存。最后输入<code>systemctl start frps &amp;&amp; systemctl enable frps</code>就设置好了开机启动。</p> <p>可以让服务端停止后再启动，然后输入<code>netstat -tanlp</code>查看进程（杀进程使用<code>kill -9 xxx</code>）。</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code># 刷新服务列表
systemctl daemon-reload
# 设置开机自启
systemctl enable frps
# 关闭开机自启
systemctl disable frps
# 启动服务
systemctl start frps
# 停止服务
systemctl stop frps
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="配置客户端里的frp"><a href="#配置客户端里的frp" class="header-anchor">#</a> 配置客户端里的frp</h3> <p>去<a href="https://github.com/fatedier/frp/releases" target="_blank" rel="noopener noreferrer">frp的GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>里选择相应的版本，比如windows我们暂时使用的是<code>frp_0.35.0_windows_amd64.zip</code>，下载解压到本地某个目录下，删除<code>frps</code>、<code>frps.ini</code>和<code>frps_full.ini</code>与客户端无关的文件。使用文本编辑器打开<code>frpc.ini</code>编辑如下</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>[common]
server_addr = 139.224.248.233
server_port = 7000
token = 88888888

[rdc]
type = tcp
local_ip = 127.0.0.1
local_port = 3389
remote_port = 3360
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>上面的<code>server_addr = 139.224.248.233</code>是frps服务端所在的云服务器的公网IP（阿里云ECS实例公网IP）；<code>server_port = 7000</code>是frps服务端所依赖的端口，frpc和frps之间的连接就依赖于这个<code>7000</code>端口；<code>token = 88888888</code>是frpc和frps之间的通信令牌，在frps也同样设置过了；<code>[rdc]</code>是自定义名字；<code>type = tcp</code>是因为我们使用<a href="https://docs.microsoft.com/zh-cn/windows-server/remote/remote-desktop-services/clients/remote-desktop-clients" target="_blank" rel="noopener noreferrer">RD Client<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，它是tcp类型的；<code>local_ip= 127.0.0.1</code>是本地机器IP（暂时就填默认的<code>127.0.0.1</code>）；<code>local_port = 3389</code>是你要映射本地机器的哪个端口，因为要使用RD Client，所以是<code>3389</code>端口；<code>remote_port = 3360</code>表示将本地的那个端口要映射到远程frps所在服务器的哪个端口，总的来说就是将本地的<code>3389</code>端口映射到<code>139.xxx.xxx.xxx</code>的<code>3360</code>端口。</p> <p>我们需要在电脑开机时自动运行客户端的frp。在frp目录下新建startfrpc.bat批处理文件，使用文本编辑器打开并编辑：</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>@echo off
:: 定义WIFI名称
set wifi_name=TP-LINK_602
:: 连接WIFI，查看当前连接信息，并且是否是wifi_name
(netsh WLAN show interfaces | findStr %wifi_name% &gt;nul) || (
    :: ||表示否则，意味着当前连接不是wifi_name，那就netsh wlan connect连接wifi_name
    netsh wlan connect ssid=%wifi_name% name=%wifi_name%
)
:: 延迟2秒
timeout /t 2 /nobreak
:: 得确保联网后再运行frpc，看是否已经启动了frpc，&gt;nul表示前面这句信息不输出到cmd框
(tasklist|findstr &quot;frp&quot; &gt;nul) || (
    :: 没有启动frpc，就在这启动frpc，||表示否则
    d:\frp_0.35.0_windows_amd64\frpc.exe -c d:\frp_0.35.0_windows_amd64\frpc.ini
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>我们将startfrpc.bat加入到任务计划程序。打开电脑的“任务计划程序”，选择右侧的“创建任务...”。</p> <ul><li>在常规这个页签里，名称填为“frpc”，然后勾上“不管用户是否登录都要运行”、“使用最高权限运行”、“隐藏”。</li> <li>在触发器这个页签里，选择新建，然后开始任务选择“启动时”，可以自己选择是否重复执行以及间隔。</li> <li>在操作这个页签里，选择新建，然后点击“浏览”选择前面创建的“start.bat”（D:\frp_0.35.0_windows_amd64\start.bat），最后在“起始于”里填写start.bat的父路径（D:\frp_0.35.0_windows_amd64）。</li> <li>返回常规页签，然后点击确定，输入电脑登录密码，就完成了frpc的自启动。</li></ul> <h3 id="给云服务器设置安全组"><a href="#给云服务器设置安全组" class="header-anchor">#</a> 给云服务器设置安全组</h3> <p>云服务器<strong>内部</strong>的frps依赖的<code>7000</code>可以不用管，因为你在服务器命令行里输入<code>firewall-cmd --state</code>，会发现阿里云服务器操作系统内的防火墙是默认关闭的，所以内部使用<code>7000</code>端口可以不用管了。如果你要放开云服务器本身的防火墙并添加<code>7000</code>端口，可以参考如下命令。</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code># 先查看防火墙状态
firewall-cmd --state
# 启用防火墙
systemctl start firewalld
# 停用防火墙
systemctl stop firewalld
firewall-cmd --zone=public --add-port=7000/udp --permanent 
firewall-cmd --zone=public --add-port=7000/tcp --permanent 
# 放行端口后要重新加载
firewall-cmd --reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>而<strong>外部</strong>想访问服务器以及它的一些端口，那就必须放开一些端口，这个是在<a href="https://ecs.console.aliyun.com/" target="_blank" rel="noopener noreferrer">阿里云控制台<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>——网络与安全——安全组。frpc所在机器想与云服务里的frps进行通信连接，需要开放云服务器安全组的<code>7000</code>给外部用；然后我们要使用RDClient进行远程桌面控制，通过frp将<code>3389</code>映射到云服务器的<code>3360</code>端口了，那么还需要开放云服务器安全组的<code>3360</code>给外部用。<code>7000</code>和<code>3360</code>开放给谁，也要限定好，不是谁想加就加的。</p> <p><img src="/blog-vuepress/assets/img/frp开放安全组端口.2e6b66c0.png" alt="安全组"></p> <p>安全组的授权对象我们使用的是<a href="https://ecs.console.aliyun.com/#/prefixList/cn-shanghai" target="_blank" rel="noopener noreferrer">前缀列表<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="说在最后"><a href="#说在最后" class="header-anchor">#</a> 说在最后</h2> <p>使用Frp还是挺简单的，但是它的安全性还是有些差，功能上也只是反向代理、映射端口，如果想异地组网（虚拟局域网）那就不能使用Frp了，可以使用<a href="/blog-vuepress/book-sketches/电脑工具/SoftEther实现虚拟局域网.html">SoftEther实现虚拟局域网</a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/6/2022, 3:41:21 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog-vuepress/book-sketches/电脑工具/谷歌浏览器使用.html" class="prev">
        谷歌浏览器使用
      </a></span> <span class="next"><a href="/blog-vuepress/book-sketches/电脑工具/SoftEther实现虚拟局域网.html">
        SoftEther实现虚拟局域网
      </a>
      →
    </span></p></div> </main> <div class="right-sidebar-wrapper right-sidebar-hidden"><aside class="right-sidebar"><ul><h4>本文目录</h4></ul></aside> <div class="sidebar-toggle" data-v-10bfdc0c><div class="sidebar-toggle-button" data-v-10bfdc0c><span data-v-10bfdc0c></span><span data-v-10bfdc0c></span><span data-v-10bfdc0c></span></div></div></div></div><div class="global-ui"></div></div>
    <script src="/blog-vuepress/assets/js/app.0d2e1fde.js" defer></script><script src="/blog-vuepress/assets/js/2.a046c74e.js" defer></script><script src="/blog-vuepress/assets/js/43.04bbcb6b.js" defer></script>
  </body>
</html>
