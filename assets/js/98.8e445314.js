(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{745:function(s,t,a){"use strict";a.r(t);var n=a(16),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"globals-和模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#globals-和模块"}},[s._v("#")]),s._v(" globals 和模块")]),s._v(" "),a("h2",{attrs:{id:"globals"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#globals"}},[s._v("#")]),s._v(" globals")]),s._v(" "),a("p",[a("code",{pre:!0},[s._v("globals")]),s._v(" 表示 NodeJs 中的全局属性和全局方法的，意思是在所有模块中都能使用。")]),s._v(" "),a("p",[a("code",{pre:!0},[s._v("globals")]),s._v("中有个"),a("code",{pre:!0},[s._v("global")]),s._v("，表示当前模块中的全局命名空间对象，如果将某些属性或方法放到"),a("code",{pre:!0},[s._v("global")]),s._v("里的话，就能在其他模块中通过访问这些属性或方法（必须先"),a("code",{pre:!0},[s._v("require")]),s._v("）。例如把"),a("code",{pre:!0},[s._v("var a")]),s._v("放到浏览器的"),a("code",{pre:!0},[s._v("window")]),s._v("上，那么在任何地方都能使用。而在 NodeJs 中就是放在它当前所在模块中 global 里，其他模块才能访问，否则就访问不了，具体就是下小一节的"),a("RouterLink",{attrs:{to:"/book-web/web后端/学习node.js/1.globals和模块.html#CommonJs模块"}},[s._v("CommonJs 模块")]),s._v("。")],1),s._v(" "),a("p",[a("strong",[s._v("a.js")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ll"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("sayName")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("sayName: ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module 1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nglobal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nglobal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sayName "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sayName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("strong",[s._v("b.js")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这里的require不能去掉，因为global仍属于模块的，这里必须让b.js与a.js建立依赖关系才能使用name和sayName")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" aModule "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sayName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("以下属性或方法，都是表示它当前所在模块的一些信息和方法。每个模块都有这些方法，这就导致它们看起来像是全局的"),a("code",{pre:!0},[s._v("globals")]),s._v("。")]),s._v(" "),a("ul",[a("li",[a("code",{pre:!0},[s._v("__dirname")]),s._v("：当前模块的目录名")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("__filename")]),s._v("：当前模块的文件名。这是当前模块文件的绝对路径，符号链接已解析")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("exports")]),s._v("：模块导出")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("module")]),s._v("：对模块的引用")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("require()")]),s._v("：导入模块或文件")])]),s._v(" "),a("p",[s._v("其他的"),a("code",{pre:!0},[s._v("globals")])]),s._v(" "),a("ul",[a("li",[a("code",{pre:!0},[s._v("console")]),s._v("：用于打印到 stdout 和 stderr")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("process")]),s._v("：进程对象")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("queueMicrotask(callback)")]),s._v("：放入微任务队列")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("setImmediate(callback[, ...args])")]),s._v("：本轮事件循环结束后调用")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("setInterval(callback, delay[, ...args])")]),s._v("：间隔一段时间重复执行")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("setTimeout(callback, delay[, ...args])")]),s._v("：间隔一段时间执行一次")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("clearImmediate(immediateObject)")]),s._v("：清除由"),a("code",{pre:!0},[s._v("setImmediate")]),s._v("创建的定时器")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("clearInterval(timeout)")]),s._v("：清除由"),a("code",{pre:!0},[s._v("setInterval")]),s._v("创建的定时器")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("clearTimeout(timeout)")]),s._v("：清除由"),a("code",{pre:!0},[s._v("setTimeout")]),s._v("创建的定时器")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("TextDecoder")]),s._v("：WHATWG 编码标准 TextDecoderAPI 的实现")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("TextEncoder")]),s._v("：WHATWG 编码标准 TextEncoderAPI 的实现")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("URL")]),s._v("：按照 WHATWG URL 标准实现的浏览器兼容 URL 类")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("URLSearchParams")]),s._v("：URLSearchParams API 提供对 URL 查询的读写访问")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("WebAssembly")]),s._v("：充当所有 W3C WebAssembly 相关功能的命名空间的对象")])]),s._v(" "),a("h2",{attrs:{id:"模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模块"}},[s._v("#")]),s._v(" 模块")]),s._v(" "),a("h3",{attrs:{id:"何为模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#何为模块"}},[s._v("#")]),s._v(" 何为模块")]),s._v(" "),a("p",[s._v("就是将一个项目中的 js 拆分成一个个独立的部分，以方便模块复用和维护。模块是不同于"),a("code",{pre:!0},[s._v("<script>")]),s._v("的，它具有“依赖关系”、“命名空间”、“代码组织”等特点，可以解决“js 文件加载顺序”、“全局属性/方法”、“代码隔离”等问题。")]),s._v(" "),a("h3",{attrs:{id:"commonjs-规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#commonjs-规范"}},[s._v("#")]),s._v(" CommonJs 规范")]),s._v(" "),a("p",[s._v("NodeJs 采用 CommonJs 规范实现了模块系统。CommonJs 规范规定了如何定义一个模块，如何暴露（导出）模块中的变量函数，以及如何使用定义好的模块。")]),s._v(" "),a("ul",[a("li",[s._v("在 CommonJs 规范中，一个文件就是一个模块。")]),s._v(" "),a("li",[s._v("在 CommonJs 规范中，每个文件中的变量函数都是私有的，对其他文件不可见。")]),s._v(" "),a("li",[s._v("在 CommonJs 规范中，每个文件中的变量函数必须通过"),a("code",{pre:!0},[s._v("exports")]),s._v("或者"),a("code",{pre:!0},[s._v("module.exports")]),s._v("暴露（导出）之后才能被其他文件引用。")]),s._v(" "),a("li",[s._v("在 CommonJs 规范中，想要使用其他文件暴露的变量函数必须通过"),a("code",{pre:!0},[s._v("require")]),s._v("导入模块才可以使用。")])]),s._v(" "),a("h3",{attrs:{id:"模块导出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模块导出"}},[s._v("#")]),s._v(" 模块导出")]),s._v(" "),a("p",[s._v("在"),a("RouterLink",{attrs:{to:"/book-web/web后端/学习node.js/1.globals和模块.html#globals"}},[s._v("globals")]),s._v("就讲过了将属性或方法放到"),a("code",{pre:!0},[s._v("global")]),s._v("供其他模块使用，但这不算是 CommonJs 规范式的模块使用，真正符合 CommonJs 规范式模块使用例子如下：")],1),s._v(" "),a("p",[a("strong",[s._v("a.js")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ll"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("sayName")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("sayName: ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module 1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("say")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" sayName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 或者")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* exports.name = name;\nexports.aaa = sayName;\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注意！！！导出是{}，意味着导出失败")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* exports = {\n  name,\n  sayName\n} */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注意！！！导出是sayName，意味着覆盖了，只导出了最后一次赋值")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* module.exports = name;\nmodule.exports = sayName; */")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[a("strong",[s._v("b.js")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" say "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("say")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("可以看到"),a("code",{pre:!0},[s._v("exports")]),s._v("和"),a("code",{pre:!0},[s._v("module.exports")]),s._v("并不是完全相同的，"),a("code",{pre:!0},[s._v("exports")]),s._v("只能用"),a("code",{pre:!0},[s._v("exports.xxx = xxx")]),s._v("来导出并不能直接给"),a("code",{pre:!0},[s._v("exports")]),s._v("赋值，就算赋值了也是"),a("code",{pre:!0},[s._v("{}")]),s._v("空对象；而"),a("code",{pre:!0},[s._v("module.exports")]),s._v("可以是"),a("code",{pre:!0},[s._v("module.exports.xxx = xxx")]),s._v("也可以"),a("code",{pre:!0},[s._v("module.exports = xxx")]),s._v("，只是"),a("code",{pre:!0},[s._v("module.exports = xxx")]),s._v("只能保证最后一次赋值被导出。")]),s._v(" "),a("h3",{attrs:{id:"模块导入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模块导入"}},[s._v("#")]),s._v(" 模块导入")]),s._v(" "),a("p",[s._v("模块导入是"),a("code",{pre:!0},[s._v('const xx = require("xxx")')]),s._v("。它有一些注意点：")]),s._v(" "),a("ol",[a("li",[s._v("require 导入模块时可以不添加导入模块的"),a("strong",[s._v("类型")]),s._v(" "),a("ul",[a("li",[s._v("如果没有指定导入模块的类型，那么会依次查找"),a("code",{pre:!0},[s._v(".js")]),s._v("、"),a("code",{pre:!0},[s._v(".json")]),s._v("、"),a("code",{pre:!0},[s._v(".node")]),s._v("文件。")]),s._v(" "),a("li",[s._v("无论是三种类型中的哪一种，导入之后都会转换成 JS 对象返回给我们")])])]),s._v(" "),a("li",[s._v("导入自定义模块时必须指定路径\n"),a("ul",[a("li",[s._v("require 可以导入“自定义模块（文件模块）”、“系统模块（核心模块）”、“第三方模块”")]),s._v(" "),a("li",[s._v("导入“自定义模块”时，前面必须加上路径")]),s._v(" "),a("li",[s._v("导入“系统模块”和“第三方模块”时，是不用添加路径的")])])])]),s._v(" "),a("h3",{attrs:{id:"es6-模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#es6-模块"}},[s._v("#")]),s._v(" ES6 模块")]),s._v(" "),a("p",[s._v("NodeJs8.5 版本将 ES6 的模块添加了进来，NodeJs14.17 版本才稳定下来。")]),s._v(" "),a("p",[s._v("如何在 NodeJs 中使用 ES6 模块")]),s._v(" "),a("ul",[a("li",[s._v("在以"),a("code",{pre:!0},[s._v(".mjs")]),s._v("为文件扩展名的文件中，就可以使用 ES6 模块。")]),s._v(" "),a("li",[s._v("不用"),a("code",{pre:!0},[s._v(".mjs")]),s._v('的话，可以修改 package.json "type" 字段。如果该字段'),a("strong",[s._v("不填")]),s._v("或者填写"),a("code",{pre:!0},[s._v("commonjs")]),s._v("，那么 NodeJs 会认为你将使用 CommonJs 规范的模块。如果设为"),a("code",{pre:!0},[s._v("module")]),s._v("，那就认为你使用 ES6 模块。")]),s._v(" "),a("li",[a("code",{pre:!0},[s._v("--input-type=module")]),s._v(" 标志告诉 Node.js。")])]),s._v(" "),a("p",[a("strong",[s._v("a.mjs")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ll"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("sayName")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("sayName: ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module 1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sayName "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("strong",[s._v("b.mjs")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sayName "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./a.mjs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sayName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("ES6 模块和 CommonJs 模块差异")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("没有 require、exports 或 module.exports。在大多数情况下，可以使用 ES 模块 import 加载 CommonJS 模块。如果需要，可以使用 module.createRequire() 在 ES 模块中构造 require 函数。")])]),s._v(" "),a("li",[a("p",[s._v("没有 **filename 或 **dirname。这些 CommonJS 变量在 ES 模块中不可用。")])]),s._v(" "),a("li",[a("p",[s._v("没有 JSON 模块加载。JSON 导入仍处于实验阶段，仅通过 --experimental-json-modules 标志支持。本地 JSON 文件可以直接用 fs 相对于 import.meta.url 加载。也可以使用 module.createRequire()。")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" readFile "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fs/promises"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("readFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./dat.json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("meta"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("没有原生模块加载，ES 模块导入当前不支持原生模块。它们可以改为加载 module.createRequire() 或 process.dlopen。")])]),s._v(" "),a("li",[a("p",[s._v("没有 require.resolve。相对解析可以通过 new URL('./local', import.meta.url) 处理。对于完整的 require.resolve 替换，有标记的实验性 import.meta.resolve API。")])]),s._v(" "),a("li",[a("p",[s._v("没有 NODE_PATH，NODE_PATH 不是解析 import 说明符的一部分。 如果需要这种行为，则使用符号链接。")])]),s._v(" "),a("li",[a("p",[s._v("没有 require.extensions，require.extensions 没有被 import 使用。 期望加载器钩子在未来可以提供这个工作流。")])]),s._v(" "),a("li",[a("p",[s._v("没有 require.cache，require.cache 没有被 import 使用，因为 ES 模块加载器有自己独立的缓存。")])])]),s._v(" "),a("h2",{attrs:{id:"包、npm、yarn"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#包、npm、yarn"}},[s._v("#")]),s._v(" 包、Npm、Yarn")]),s._v(" "),a("p",[a("strong",[s._v("包")]),s._v("是一个或多个模块组成的一个集合（或者说是一个项目），使用本地的包或者模块时直接使用"),a("code",{pre:!0},[s._v("require(路径+模块名)")]),s._v("，如果你想使用第三方包，那就需要包管理工具 Npm 或者 Yarn。")]),s._v(" "),a("p",[s._v("关于 Npm 可以看"),a("RouterLink",{attrs:{to:"/book-web/常用工具/Npm的使用.html"}},[s._v("Npm 的使用")]),s._v("。关于 Yarn 可以看"),a("a",{attrs:{href:"https://yarn.bootcss.com/docs/usage",target:"_blank",rel:"noopener noreferrer"}},[s._v("Yarn 官网"),a("OutboundLink")],1),s._v("。")],1)])}),[],!1,null,null,null);t.default=e.exports}}]);