<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数据查询语言 DQL | Liawn&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <meta charset="UTF-8">
  <link rel="icon" href="/blog-vuepress/favicon.ico">
  <link rel="manifest" href="/blog-vuepress/manifest.json">
  <meta name="theme-color" content="#ffffff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/blog-vuepress/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/blog-vuepress/safari-pinned-tab.svg" color="#ffffff">
  <meta name="msapplication-TileImage" content="/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    <meta name="description" content="用vuepress搭建的个人博客">
    <meta charset="UTF-8">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/blog-vuepress/assets/css/0.styles.2f620dda.css" as="style"><link rel="preload" href="/blog-vuepress/assets/js/app.34680ebc.js" as="script"><link rel="preload" href="/blog-vuepress/assets/js/2.1e7adb41.js" as="script"><link rel="preload" href="/blog-vuepress/assets/js/96.beed2305.js" as="script"><link rel="preload" href="/blog-vuepress/assets/js/38.cec9a03e.js" as="script"><link rel="prefetch" href="/blog-vuepress/assets/js/10.1e723314.js"><link rel="prefetch" href="/blog-vuepress/assets/js/100.311567ba.js"><link rel="prefetch" href="/blog-vuepress/assets/js/101.ef72e26e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/102.c3759919.js"><link rel="prefetch" href="/blog-vuepress/assets/js/103.98e877a9.js"><link rel="prefetch" href="/blog-vuepress/assets/js/104.e27de6a0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/105.3a1ef548.js"><link rel="prefetch" href="/blog-vuepress/assets/js/106.59ee0f92.js"><link rel="prefetch" href="/blog-vuepress/assets/js/107.e68abe87.js"><link rel="prefetch" href="/blog-vuepress/assets/js/108.8fcda232.js"><link rel="prefetch" href="/blog-vuepress/assets/js/109.422d008d.js"><link rel="prefetch" href="/blog-vuepress/assets/js/11.58bde1dd.js"><link rel="prefetch" href="/blog-vuepress/assets/js/110.f713fc26.js"><link rel="prefetch" href="/blog-vuepress/assets/js/111.58efaae4.js"><link rel="prefetch" href="/blog-vuepress/assets/js/112.c6bdfbe0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/113.8dbd693e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/114.8a85e37a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/115.54a6972e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/116.56b2d8b8.js"><link rel="prefetch" href="/blog-vuepress/assets/js/117.11470546.js"><link rel="prefetch" href="/blog-vuepress/assets/js/118.1a39e213.js"><link rel="prefetch" href="/blog-vuepress/assets/js/119.41f15fbd.js"><link rel="prefetch" href="/blog-vuepress/assets/js/12.613505ee.js"><link rel="prefetch" href="/blog-vuepress/assets/js/120.9ac14643.js"><link rel="prefetch" href="/blog-vuepress/assets/js/121.83954220.js"><link rel="prefetch" href="/blog-vuepress/assets/js/122.bef8fade.js"><link rel="prefetch" href="/blog-vuepress/assets/js/123.25446ff9.js"><link rel="prefetch" href="/blog-vuepress/assets/js/124.6acf9e60.js"><link rel="prefetch" href="/blog-vuepress/assets/js/125.42c6fb5e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/126.b9b98daa.js"><link rel="prefetch" href="/blog-vuepress/assets/js/127.382eea79.js"><link rel="prefetch" href="/blog-vuepress/assets/js/13.75740994.js"><link rel="prefetch" href="/blog-vuepress/assets/js/14.febc6ec1.js"><link rel="prefetch" href="/blog-vuepress/assets/js/15.6e16849c.js"><link rel="prefetch" href="/blog-vuepress/assets/js/16.70db9d99.js"><link rel="prefetch" href="/blog-vuepress/assets/js/17.f098e403.js"><link rel="prefetch" href="/blog-vuepress/assets/js/18.21ad25ae.js"><link rel="prefetch" href="/blog-vuepress/assets/js/19.4b561714.js"><link rel="prefetch" href="/blog-vuepress/assets/js/20.8dae8a78.js"><link rel="prefetch" href="/blog-vuepress/assets/js/21.7d09e2a3.js"><link rel="prefetch" href="/blog-vuepress/assets/js/22.7838f809.js"><link rel="prefetch" href="/blog-vuepress/assets/js/23.2444198c.js"><link rel="prefetch" href="/blog-vuepress/assets/js/24.099866db.js"><link rel="prefetch" href="/blog-vuepress/assets/js/25.d059d716.js"><link rel="prefetch" href="/blog-vuepress/assets/js/26.243af3f2.js"><link rel="prefetch" href="/blog-vuepress/assets/js/27.97e455c9.js"><link rel="prefetch" href="/blog-vuepress/assets/js/28.97ce9b54.js"><link rel="prefetch" href="/blog-vuepress/assets/js/29.392d550e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/3.49db6791.js"><link rel="prefetch" href="/blog-vuepress/assets/js/30.9161535d.js"><link rel="prefetch" href="/blog-vuepress/assets/js/31.46b99656.js"><link rel="prefetch" href="/blog-vuepress/assets/js/32.c2fd0854.js"><link rel="prefetch" href="/blog-vuepress/assets/js/33.3080b8a5.js"><link rel="prefetch" href="/blog-vuepress/assets/js/34.e15baec0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/35.f144a7bd.js"><link rel="prefetch" href="/blog-vuepress/assets/js/36.e1175535.js"><link rel="prefetch" href="/blog-vuepress/assets/js/37.72ec58bc.js"><link rel="prefetch" href="/blog-vuepress/assets/js/39.fc6f4606.js"><link rel="prefetch" href="/blog-vuepress/assets/js/4.eca03551.js"><link rel="prefetch" href="/blog-vuepress/assets/js/40.b74ded47.js"><link rel="prefetch" href="/blog-vuepress/assets/js/41.cee8cec1.js"><link rel="prefetch" href="/blog-vuepress/assets/js/42.7f4e1373.js"><link rel="prefetch" href="/blog-vuepress/assets/js/43.10c6d899.js"><link rel="prefetch" href="/blog-vuepress/assets/js/44.4f190d43.js"><link rel="prefetch" href="/blog-vuepress/assets/js/45.5c2f36ae.js"><link rel="prefetch" href="/blog-vuepress/assets/js/46.9a5337f5.js"><link rel="prefetch" href="/blog-vuepress/assets/js/47.161b10c1.js"><link rel="prefetch" href="/blog-vuepress/assets/js/48.93192e20.js"><link rel="prefetch" href="/blog-vuepress/assets/js/49.72ba1cc4.js"><link rel="prefetch" href="/blog-vuepress/assets/js/5.aacc9c46.js"><link rel="prefetch" href="/blog-vuepress/assets/js/50.bfc0c26a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/51.05bbb696.js"><link rel="prefetch" href="/blog-vuepress/assets/js/52.84b5a67c.js"><link rel="prefetch" href="/blog-vuepress/assets/js/53.220715ca.js"><link rel="prefetch" href="/blog-vuepress/assets/js/54.d433d73f.js"><link rel="prefetch" href="/blog-vuepress/assets/js/55.f8221d0f.js"><link rel="prefetch" href="/blog-vuepress/assets/js/56.2ec79246.js"><link rel="prefetch" href="/blog-vuepress/assets/js/57.01a3b85e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/58.9015a667.js"><link rel="prefetch" href="/blog-vuepress/assets/js/59.73311086.js"><link rel="prefetch" href="/blog-vuepress/assets/js/6.0c335663.js"><link rel="prefetch" href="/blog-vuepress/assets/js/60.976cf8cc.js"><link rel="prefetch" href="/blog-vuepress/assets/js/61.4a1c95f1.js"><link rel="prefetch" href="/blog-vuepress/assets/js/62.865f814a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/63.0d882dec.js"><link rel="prefetch" href="/blog-vuepress/assets/js/64.c74f770a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/65.0d5262a8.js"><link rel="prefetch" href="/blog-vuepress/assets/js/66.1cd8fc00.js"><link rel="prefetch" href="/blog-vuepress/assets/js/67.a73db0e8.js"><link rel="prefetch" href="/blog-vuepress/assets/js/68.2fe7b184.js"><link rel="prefetch" href="/blog-vuepress/assets/js/69.763746bf.js"><link rel="prefetch" href="/blog-vuepress/assets/js/7.09a81cb8.js"><link rel="prefetch" href="/blog-vuepress/assets/js/70.2f10d153.js"><link rel="prefetch" href="/blog-vuepress/assets/js/71.f0476a16.js"><link rel="prefetch" href="/blog-vuepress/assets/js/72.b3aa24c4.js"><link rel="prefetch" href="/blog-vuepress/assets/js/73.d90b4378.js"><link rel="prefetch" href="/blog-vuepress/assets/js/74.5f3afc25.js"><link rel="prefetch" href="/blog-vuepress/assets/js/75.610a9393.js"><link rel="prefetch" href="/blog-vuepress/assets/js/76.397a07d0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/77.a7a16098.js"><link rel="prefetch" href="/blog-vuepress/assets/js/78.0a76e3c0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/79.d9bf3b6d.js"><link rel="prefetch" href="/blog-vuepress/assets/js/8.7a4382cf.js"><link rel="prefetch" href="/blog-vuepress/assets/js/80.6653af85.js"><link rel="prefetch" href="/blog-vuepress/assets/js/81.7bfd7632.js"><link rel="prefetch" href="/blog-vuepress/assets/js/82.e5ec57b6.js"><link rel="prefetch" href="/blog-vuepress/assets/js/83.7728c890.js"><link rel="prefetch" href="/blog-vuepress/assets/js/84.dd67c36e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/85.7387a0e5.js"><link rel="prefetch" href="/blog-vuepress/assets/js/86.bbfe7f7f.js"><link rel="prefetch" href="/blog-vuepress/assets/js/87.2de3f2a7.js"><link rel="prefetch" href="/blog-vuepress/assets/js/88.809122f0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/89.321e8e47.js"><link rel="prefetch" href="/blog-vuepress/assets/js/9.26929067.js"><link rel="prefetch" href="/blog-vuepress/assets/js/90.5ce6c826.js"><link rel="prefetch" href="/blog-vuepress/assets/js/91.075154c5.js"><link rel="prefetch" href="/blog-vuepress/assets/js/92.11b94685.js"><link rel="prefetch" href="/blog-vuepress/assets/js/93.a9d4d5f0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/94.306ece7e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/95.817525f6.js"><link rel="prefetch" href="/blog-vuepress/assets/js/97.b4c539f2.js"><link rel="prefetch" href="/blog-vuepress/assets/js/98.8e445314.js"><link rel="prefetch" href="/blog-vuepress/assets/js/99.558669ea.js">
    <link rel="stylesheet" href="/blog-vuepress/assets/css/0.styles.2f620dda.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><a href="/blog-vuepress/" class="home-link router-link-active"><!----> <span class="site-name">Liawn's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog-vuepress/book-web/" class="nav-link router-link-active">
  Web
</a></div><div class="nav-item"><a href="/blog-vuepress/book-sketches/" class="nav-link">
  生活
</a></div> <!----></nav></div></header> <div class="sidebar-wrapper sidebar-hidden"><aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog-vuepress/book-web/" class="nav-link router-link-active">
  Web
</a></div><div class="nav-item"><a href="/blog-vuepress/book-sketches/" class="nav-link">
  生活
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><!----> <span>web前端</span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/html、css、js、ts/学习JavaScript/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习JavaScript</span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/html、css、js、ts/学习CSS/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习CSS</span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/html、css、js、ts/学习TypeScript/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习TypeScript</span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/web前端js框架/学习Vue/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习Vue</span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/web前端js框架/学习React/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习React</span></a> <!----></section></li><li><a href="/blog-vuepress/book-web/web前端js框架/学习jQuery.html" class="sidebar-link">jQueryNote</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/LayaBox游戏引擎/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>H5游戏引擎Laya</span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span>常用工具</span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog-vuepress/book-web/常用工具/Npm的使用.html" class="sidebar-link">Npm 的使用</a></li><li><a href="/blog-vuepress/book-web/常用工具/Git的使用.html" class="sidebar-link">Git 的使用</a></li><li><a href="/blog-vuepress/book-web/常用工具/webpack的使用.html" class="sidebar-link">webpack 的使用</a></li><li><a href="/blog-vuepress/book-web/常用工具/VSCode的使用.html" class="sidebar-link">VSCode 的使用</a></li><li><a href="/blog-vuepress/book-web/常用工具/Chrome的使用.html" class="sidebar-link">Chrome 的使用</a></li><li><a href="/blog-vuepress/book-web/常用工具/使用vuepress写blog.html" class="sidebar-link">使用 vuepress 写 blog</a></li><li><a href="/blog-vuepress/book-web/常用工具/使用docsify写blog.html" class="sidebar-link">使用 docsify 写 blog</a></li><li><a href="/blog-vuepress/book-web/常用工具/使用gitbook写blog.html" class="sidebar-link">使用 gitbook 写 blog</a></li><li><a href="/blog-vuepress/book-web/web前端测试与调试/基于mocha+chai的单元测试.html" class="sidebar-link">使用 mocha+chai 进行单元测试</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span>Web后端</span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/web后端/学习node.js/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习node.js</span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/web后端/学习python/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习python</span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span>简单项目实践</span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/项目/react+express+ts写爬虫/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>react+express+ts写爬虫</span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span>数据结构与算法</span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/数据结构与算法/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>数据结构与算法ts版</span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span>面试准备</span></p> <!----></section></li></ul> </aside> <div class="sidebar-toggle" data-v-10bfdc0c><div class="sidebar-toggle-button" data-v-10bfdc0c><span data-v-10bfdc0c></span><span data-v-10bfdc0c></span><span data-v-10bfdc0c></span></div></div></div> <main class="page sidebar-hidden right-sidebar-hidden"> <div class="theme-default-content content__default"><h1 id="数据查询语言-dql"><a href="#数据查询语言-dql" class="header-anchor">#</a> 数据查询语言 DQL</h1> <h2 id="基础查询"><a href="#基础查询" class="header-anchor">#</a> 基础查询</h2> <p>基础查询语法：<code>select 查询列表 from 表名</code>。</p> <p>查询列表可以是表中的字段、常量值、表达式、函数。最后查询出的结果是一个虚拟的表格。</p> <ul><li>查询表中的单个字段<br> <code>SELECT last_name FROM employees</code></li> <li>查询表中多个字段<br> <code>SELECT last_name,salary,email FROM employees</code></li> <li>查询表中所有字段<br> <code>SELECT * FROM employees</code></li> <li>查询常量值<br> <code>SELECT 100</code></li> <li>查询表达式<br> <code>SELECT 100%98</code></li> <li>查询函数返回值<br> <code>SELECT VERSION()</code></li></ul> <p><strong>取别名</strong>：我们可以在查询时给<strong>表</strong>和<strong>列</strong>来取<strong>别名</strong>，是为了方便理解方便查看。写法：<code>表名 [AS] 别名</code>和<code>列名 [AS] 别名</code>，没错<code>AS</code>可以省略。我们还可以使用<code>CONCAT()</code>将多列拼接成同一列展示，最后使用别名作为查询结果新列名。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 取别名，带上AS，别名最好是加上双引号，因为可能是多单词组成</span>
<span class="token keyword">SELECT</span> <span class="token number">100</span><span class="token operator">%</span><span class="token number">98</span> <span class="token keyword">AS</span> <span class="token string">&quot;结果&quot;</span><span class="token punctuation">;</span>
<span class="token comment"># 取别名，带上AS，别名最好是加上双引号，因为可能是多单词组成</span>
<span class="token keyword">SELECT</span> last_name <span class="token keyword">AS</span> <span class="token string">&quot;姓&quot;</span><span class="token punctuation">,</span> first_name <span class="token keyword">AS</span> <span class="token string">&quot;名&quot;</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># 取别名，省略AS，别名最好是加上双引号，因为可能是多单词组成</span>
<span class="token keyword">SELECT</span> salary <span class="token string">&quot;out put&quot;</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># CONCAT()搭配别名使用</span>
<span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>last_name<span class="token punctuation">,</span>first_name<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">&quot;姓名&quot;</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>去重</strong>：在某些表里，在查询一些字段的值时结果可能会出现<strong>重复</strong>，那么我们可以使用<code>DISTINCT</code>关键字了。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 使用DISTINCT关键字进行查询结果去重</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> department_id <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>+加号</strong>：<code>+</code>在 MYSQL 中的作用是<strong>加号运算</strong></p> <ul><li>如果两个都是数值型，就只加做加法运算
<code>SELECT 10+90 AS &quot;结果&quot;</code></li> <li>只有其中一个为<code>NULL</code>，那结果就是<code>NULL</code> <code>SELECT NULL+90 AS &quot;结果&quot;</code></li> <li>如果其中一个是数值型，另一个是数值型字符，那就会将数值型字符转为对应数值，再做加法运算。
<code>SELECT '10'+90 AS &quot;结果&quot;</code></li> <li>如果其中一个是数值型，另一个是非数值字符型，那就会将非数值字符型转为数值<code>0</code>，再做加法运算。
<code>SELECT 'john'+90 AS &quot;结果&quot;</code></li></ul> <h2 id="条件查询"><a href="#条件查询" class="header-anchor">#</a> 条件查询</h2> <p>条件查询就是字面意思，按照某些条件进行查询。</p> <p>写法：<code>select 查询列表 from 表名 where 条件</code>。</p> <h3 id="普通条件查询"><a href="#普通条件查询" class="header-anchor">#</a> 普通条件查询</h3> <p><strong>普通条件查询</strong>一般是按照“条件”进行查询，它会用到<strong>条件运算符</strong>：<code>&gt;</code>、<code>&lt;</code>、<code>=</code>、<code>&lt;=</code>、<code>&gt;=</code>、<code>&lt;&gt;</code>、<code>!=</code>。（“不等于”建议使用<code>&lt;&gt;</code>）</p> <p>一旦“条件”很<strong>复杂</strong>，满足所有条件、满足其中一个条件、相反条件等，就会用到<strong>逻辑运算符</strong>：<code>and</code>、<code>or</code>、<code>not</code>、<code>&amp;&amp;</code>、<code>||</code>、<code>!</code>。（建议使用前三个）</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># &gt;、&lt;：查询工资大于12000的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> salary <span class="token operator">&gt;</span> <span class="token number">12000</span><span class="token punctuation">;</span>
<span class="token comment"># &lt;&gt;、!=：查询部门编号不等于90号的员工名和部门编号。`&lt;&gt;`也可以用`!=`，最好用前者</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_id <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> department_id<span class="token operator">&lt;&gt;</span><span class="token number">90</span><span class="token punctuation">;</span>
<span class="token comment"># AND、&amp;&amp;：查询工资在10000到20000之间的员工名、工资。`AND`也可以用`&amp;&amp;`，最好用前者</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> salary<span class="token operator">&gt;=</span><span class="token number">10000</span> <span class="token operator">AND</span> salary<span class="token operator">&lt;=</span><span class="token number">20000</span><span class="token punctuation">;</span>
<span class="token comment"># OR：查询部门编号不是在90到110之间，或者工资高于15000的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> department_id<span class="token operator">&lt;</span><span class="token number">90</span> <span class="token operator">OR</span> department_id<span class="token operator">&gt;</span><span class="token number">110</span> <span class="token operator">OR</span> salary<span class="token operator">&gt;</span><span class="token number">15000</span><span class="token punctuation">;</span>
<span class="token comment"># NOT、AND、OR：同上例</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> <span class="token operator">NOT</span><span class="token punctuation">(</span>department_id<span class="token operator">&gt;=</span><span class="token number">90</span> <span class="token operator">AND</span> department_id<span class="token operator">&lt;=</span><span class="token number">110</span><span class="token punctuation">)</span> <span class="token operator">OR</span> salary<span class="token operator">&gt;</span><span class="token number">15000</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="模糊查询"><a href="#模糊查询" class="header-anchor">#</a> 模糊查询</h3> <p><strong>模糊查询</strong>是“条件”很简略，可能是字段值的某一部分，也可能是在一个范围内。它有<code>LIKE</code>、<code>BETWEEN AND</code>、<code>IN</code>、<code>IS NULL</code>、<code>IS NOT NULL</code>几种模糊查询类型。</p> <ol><li><p><code>LIKE</code>:一般和通配符搭配使用，通配符<code>%</code>表示任意多个字符，<code>_</code>表示任意单个字符。如果需要区分大小写，可以在<code>LIKE</code>后追加<code>BINARY</code>关键字。如果需要查<code>_</code>本身这个符号，可以使用转译<code>\_</code>（或者用<code>ESCAPE</code>关键字指定某个字符代表<code>\</code>，该字符没有字符原来意义了而是具有了转译功能）。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># %为任意多个字符：查询员工名中包含字符a的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">'%a%'</span><span class="token punctuation">;</span>
<span class="token comment"># _为任意单个字符：查询员工名中第三个字符是e第五个字符是n的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">'__e_n%'</span><span class="token punctuation">;</span>
<span class="token comment"># 加上BINARY可区分大小写：查询员工名中第四个字符是大写H的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token keyword">BINARY</span> <span class="token string">'___H%'</span><span class="token punctuation">;</span>
<span class="token comment"># 使用\进行转译：查询员工名中第二个字符是_的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">'_\_%'</span><span class="token punctuation">;</span>
<span class="token comment"># 使用ESCAPE指定某字符具有转译功能，该字符本身已经不是它原来的意思了。本例同'_\_%'一样。</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">'_a_%'</span> <span class="token keyword">ESCAPE</span> <span class="token string">'a'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p><code>BETWEEN AND</code>：范围查询，它相当于<code>xx &gt;= 下限 AND xx &lt;= 上限</code>，只是<code>BETWEEN 下限 AND 上限</code>更简洁，<code>BETWEEN AND</code>会包含上下限这两个临界值。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># BETWEEN AND（包含临界值）：查询工资在10000到20000之间的员工名、工资</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> salary <span class="token operator">BETWEEN</span> <span class="token number">10000</span> <span class="token operator">AND</span> <span class="token number">20000</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p><code>IN</code>：相当于<code>xx=值1 OR xx=值2 OR xx=值3</code>，用<code>IN</code>的写法会更简洁，<code>IN(值1,值2,值3)</code>，只是“值 123”的类型要一致或者兼容（可隐式转换），还有“值 123”不要使用通配符，因为<code>IN</code>实际是<code>=</code>形式的，不是<code>LIKE</code>所以不能用通配符。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># IN：查询员工工种编号是IT_PROG或者AD_VP或者ST_MAN的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> job_id <span class="token operator">IN</span><span class="token punctuation">(</span><span class="token string">'IT_PROG'</span><span class="token punctuation">,</span><span class="token string">'AD_VP'</span><span class="token punctuation">,</span><span class="token string">'ST_MAN'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p><code>IS NULL</code>和<code>IS NOT NULL</code>：判断字段值是否为<code>NULL</code>的。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># IS NULL和IS NOT NULL：查询奖金为空的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>说到<code>IS NULL</code>，其实它可以用安全等于<code>&lt;=&gt;</code>实现。<code>IS NULL</code>只能用在<code>NULL</code>的场景，而<code>&lt;=&gt;</code>可以适用于<code>NULL</code>也可以适用于具体值场景。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># &lt;=&gt;是安全等于，用于判断是否等于NULL，也可用于是否等于一个具体值，但是用得很少</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> commission_pct <span class="token operator">&lt;=&gt;</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> salary <span class="token operator">&lt;=&gt;</span> <span class="token number">12000</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol> <h2 id="排序查询"><a href="#排序查询" class="header-anchor">#</a> 排序查询</h2> <p><strong>排序</strong>：我们有时候需要把查询结果按照一个字段值的升序或降序进行排列展示，那我们可以使用<code>ORDER BY</code>关键字了。ASC 升序（默认），DESC 是降序。<code>ORDER BY</code>支持单字段、多字段、表达式、函数、别名。<code>ORDER BY</code>字句一般放在查询语句的最后面（但<code>LIMIT</code>字句比它更靠后）。</p> <ol><li><p>普通排序</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 使用ORDER BY进行排序，ASC升序（默认），DESC是降序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary<span class="token punctuation">;</span>
<span class="token comment"># 加上WHERE条件进行排序查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> salary<span class="token operator">&gt;=</span><span class="token number">12000</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>按表达式排序</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 按表达式排序：按年薪的高低显示员工信息和年薪</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span> salary<span class="token operator">*</span><span class="token number">12</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> employees
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary<span class="token operator">*</span><span class="token number">12</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>按别名排序</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 按别名排序：按年薪的高低显示员工信息和年薪</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span> salary<span class="token operator">*</span><span class="token number">12</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 年薪
<span class="token keyword">FROM</span> employees
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 年薪 <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>按函数排序</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 按函数排序：按姓名的长度显示员工的姓名和工资</span>
<span class="token keyword">SELECT</span> LENGTH<span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> 字节长度<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> LENGTH<span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>按多个字段排序</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 按多个字段排序：查询员工信息，先按工资降序排序，再按员工编号升序排序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span><span class="token punctuation">,</span> employee_id <span class="token keyword">ASC</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol> <h2 id="常见函数"><a href="#常见函数" class="header-anchor">#</a> 常见函数</h2> <p>常见函数一般分为：单行函数和分组函数。单行函数是处理数据用的，分组函数是统计数据用的，所以分组函数还叫统计函数、聚合函数或者组函数。</p> <h3 id="单行函数"><a href="#单行函数" class="header-anchor">#</a> 单行函数</h3> <ol><li><p>字符函数</p> <ul><li><code>length()</code>：获取参数值的字节个数。要注意不是字符长度。</li> <li><code>concat()</code>：拼接字符串。</li> <li><code>upper()</code>和<code>lower()</code>：前者是将字母都变为大写，后者是将字母都变为小写。</li> <li><code>substr()</code>或<code>substring()</code>：这两个一样，截取字符串。</li> <li><code>instr()</code>：查询子串在字符串的索引位置（类似 js 的 indexOf()）。</li> <li><code>trim()</code>：去掉字符串前后空格。如果使用<code>FORM</code>可以去掉前后指定字符。</li> <li><code>lpad()</code>和<code>rpad()</code>：用指定字符进行左填充（rpad 是右填充），最后达到指定字符长度。</li> <li><code>replace()</code>：替换字符串中的指定的字符。</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># length函数：获取参数值的字节个数。</span>
<span class="token keyword">SELECT</span> LENGTH<span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># concat函数：拼接字符串。</span>
<span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>last_name<span class="token punctuation">,</span><span class="token string">'_'</span><span class="token punctuation">,</span>first_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># upper和lower函数：前者是将字母都变为大写，后者是将字母都变为小写。</span>
<span class="token keyword">SELECT</span> UPPER<span class="token punctuation">(</span>last_name<span class="token punctuation">)</span><span class="token punctuation">,</span>LOWER<span class="token punctuation">(</span>first_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># substr或substring函数：截取字符串，第二个参数是起始点，第三个参数是截取长度</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span> SUBSTR<span class="token punctuation">(</span>last_name<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span> <span class="token comment"># mysql索引是从1开始的</span>
<span class="token comment"># instr函数：查询子串在字符串的索引位置</span>
<span class="token keyword">SELECT</span> INSTR<span class="token punctuation">(</span><span class="token string">'akldmfasdfabodfng'</span><span class="token punctuation">,</span><span class="token string">'mfa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># trim函数：去掉前后空格（或指定字符）</span>
<span class="token keyword">SELECT</span> TRIM<span class="token punctuation">(</span><span class="token string">'  A  S    '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> TRIM<span class="token punctuation">(</span><span class="token string">'G'</span> <span class="token keyword">FROM</span> <span class="token string">'GGGGGAGGGGSGGGGG'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># lpad函数：用指定字符进行左填充（rpad是右填充），最后达到指定字符长度</span>
<span class="token keyword">SELECT</span> LPAD<span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RPAD<span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># replace函数：替换字符串中的指定的字符</span>
<span class="token keyword">SELECT</span> <span class="token keyword">REPLACE</span><span class="token punctuation">(</span><span class="token string">'abcabcabc'</span><span class="token punctuation">,</span><span class="token string">'abc'</span><span class="token punctuation">,</span><span class="token string">'def'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li> <li><p>数学函数</p> <ul><li><code>round()</code>：四舍五入，第二个参数是指定保留小数点后的位数。</li> <li><code>ceil()</code>：向上取整，返回&gt;=该参数的最小整数。</li> <li><code>floor()</code>：向下取整，返回&lt;=该参数的最大整数。</li> <li><code>truncate()</code>：截断小数位，会指定截断到小数点后的位数。</li> <li><code>mod()</code>：取余，<code>mod(a,b)</code>相当于<code>a - a/b*b</code>。</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># round函数：四舍五入，第二个参数是指定保留小数点后的位数</span>
<span class="token keyword">SELECT</span> <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">1.42</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.56</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">1.567</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># ceil函数：向上取整，返回&gt;=该参数的最小整数</span>
<span class="token keyword">SELECT</span> CEIL<span class="token punctuation">(</span><span class="token number">1.00</span><span class="token punctuation">)</span><span class="token punctuation">,</span> CEIL<span class="token punctuation">(</span><span class="token number">1.02</span><span class="token punctuation">)</span><span class="token punctuation">,</span> CEIL<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.02</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># floor函数：向下取整，返回&lt;=该参数的最大整数</span>
<span class="token keyword">SELECT</span> FLOOR<span class="token punctuation">(</span><span class="token number">2.00</span><span class="token punctuation">)</span><span class="token punctuation">,</span> FLOOR<span class="token punctuation">(</span><span class="token number">2.98</span><span class="token punctuation">)</span><span class="token punctuation">,</span> FLOOR<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.98</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># truncate函数：截断小数位，会指定截断到小数点后的位数</span>
<span class="token keyword">SELECT</span> <span class="token keyword">TRUNCATE</span><span class="token punctuation">(</span><span class="token number">1.6999</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">TRUNCATE</span><span class="token punctuation">(</span><span class="token number">1.6999</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># mod函数：取余，`mod(a,b)`相当于`a - a/b*b`</span>
<span class="token keyword">SELECT</span> <span class="token function">MOD</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MOD</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MOD</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MOD</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>日期函数</p> <ul><li><code>now()</code>：返回当前系统日期+时间。</li> <li><code>curdate()</code>：返回当前系统日期，不包括时间。</li> <li><code>curtime()</code>：返回当前系统时间，不包括日期。</li> <li><code>str_to_date()</code>：按照指定格式来解析日期+时间。</li> <li><code>date_format()</code>：将日期按照指定格式来转换。</li> <li><code>year()</code>：获取参数值的年部分。</li> <li><code>month()</code>和<code>monthname()</code>：获取参数值的月部分。</li> <li><code>day()</code>：获取参数值的日部分（一个月的第几天）。</li> <li><code>hour</code>：获取参数值的小时部分。</li> <li><code>minute</code>：获取参数值的分钟部分。</li> <li><code>second</code>：获取参数值的秒部分。</li> <li><code>date()</code>：获取参数值的整体日期部分，不包括时间。</li></ul> <p><code>str_to_date()</code>和<code>date_format()</code>中会涉及的“格式”，经常会用到的一些格式符如下表：</p> <table><thead><tr><th>格式符</th> <th>功能</th></tr></thead> <tbody><tr><td>%Y</td> <td>四位年份</td></tr> <tr><td>%y</td> <td>两位年份</td></tr> <tr><td>%m</td> <td>月份（01,02,03...12）</td></tr> <tr><td>%c</td> <td>月份（1,2,3...12）</td></tr> <tr><td>%d</td> <td>月份中的第几天（01,02,03...31）</td></tr> <tr><td>%e</td> <td>月份中的第几天（1,2,3...31）</td></tr> <tr><td>%H</td> <td>小时（24 小时制，00,02,03...23）</td></tr> <tr><td>%k</td> <td>小时（24 小时制，0,1,2,3...23）</td></tr> <tr><td>%h</td> <td>小时（12 小时制，01,02,03...12）</td></tr> <tr><td>%l</td> <td>小时（12 小时制，1,2,3...12）</td></tr> <tr><td>%i</td> <td>分钟（01,02,03...59）</td></tr> <tr><td>%s</td> <td>秒（01,02,03...59）</td></tr> <tr><td>%p</td> <td>AM 或者 PM</td></tr> <tr><td>%w</td> <td>星期几（0=星期日.. 6=星期六）</td></tr> <tr><td>%W</td> <td>星期几（Sunday.. Saturday）</td></tr></tbody></table> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># now函数返回当前系统日期+时间，curdate只返回日期，curtime只返回时间</span>
<span class="token keyword">SELECT</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CURTIME<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># str_to_date函数：按照指定格式来解析日期+时间</span>
<span class="token keyword">SELECT</span> STR_TO_DATE<span class="token punctuation">(</span><span class="token string">'1992-8-15'</span><span class="token punctuation">,</span><span class="token string">'%Y-%c-%d'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>STR_TO_DATE<span class="token punctuation">(</span><span class="token string">'1992-08-15'</span><span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 查询入职日期为1992-4-3的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> hiredate <span class="token operator">=</span> STR_TO_DATE<span class="token punctuation">(</span><span class="token string">'4-3 1992'</span><span class="token punctuation">,</span><span class="token string">'%c-%d %Y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># date_format函数：将日期按照指定格式来转换</span>
<span class="token keyword">SELECT</span> DATE_FORMAT<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%y年%c月%e日'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 查询有奖金的员工名和入职日期（xx月/xx日 xx年）</span>
<span class="token keyword">SELECT</span> last_name <span class="token keyword">AS</span> 员工名<span class="token punctuation">,</span>DATE_FORMAT<span class="token punctuation">(</span>hiredate<span class="token punctuation">,</span> <span class="token string">'%m月/%d日 %y年'</span><span class="token punctuation">)</span> 入职时间
<span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
<span class="token comment"># year和day函数：获取年和日</span>
<span class="token keyword">SELECT</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">MONTH</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>MONTHNAME<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">DAY</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">HOUR</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">MINUTE</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">SECOND</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># date获取整体的日期，不包括时间</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li> <li><p>流程控制函数</p> <ul><li><p><code>if(expr1,expr2,expr3)</code>：如果 expr1 为 true，就返回 expr2，否则返回 expr3。</p></li> <li><p><code>case()</code>有两种写法：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 这种写法的逻辑类似于`switch case`等值判断</span>
<span class="token keyword">case</span> 要判断的字段或表达式
<span class="token keyword">when</span> 常量<span class="token number">1</span> <span class="token keyword">then</span> 要显示的值<span class="token number">1</span>（在存储过程中是语句）
<span class="token keyword">when</span> 常量<span class="token number">2</span> <span class="token keyword">then</span> 要显示的值<span class="token number">2</span>（在存储过程中是语句）
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">else</span> 要显示的值n（在存储过程中是语句）
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 这种写法的逻辑类似于`if else if else`这种区间判断</span>
<span class="token keyword">case</span>
<span class="token keyword">when</span> 条件<span class="token number">1</span> <span class="token keyword">then</span> 要显示的值<span class="token number">1</span>（在存储过程中是语句）
<span class="token keyword">when</span> 条件<span class="token number">2</span> <span class="token keyword">then</span> 要显示的值<span class="token number">2</span>（在存储过程中是语句）
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">else</span> 要显示的值n（在存储过程中是语句）
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># if(expr1,expr2,expr3)：如果expr1为true，就返回expr2，否则返回expr3</span>
<span class="token keyword">SELECT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">&gt;</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'真的'</span><span class="token punctuation">,</span><span class="token string">'假的'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 使用if给员工奖金加备注</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span> <span class="token keyword">IF</span><span class="token punctuation">(</span>commission_pct <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'没有奖金'</span><span class="token punctuation">,</span> <span class="token string">'有奖金'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 奖金 <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># case函数：类似于js中switch和if else。</span>
<span class="token comment">/*
查询员工的工资，要求
部门号=30，显示的工资为1.1倍
部门号=40，显示的工资为1.2倍
部门号=50，显示的工资为1.3倍
其他部门，显示的工资为原工资
*/</span>
<span class="token keyword">SELECT</span> salary <span class="token keyword">AS</span> 原工资<span class="token punctuation">,</span> department_id<span class="token punctuation">,</span>
<span class="token keyword">CASE</span> department_id
<span class="token keyword">WHEN</span> <span class="token number">30</span> <span class="token keyword">THEN</span> salary<span class="token operator">*</span><span class="token number">1.1</span>
<span class="token keyword">WHEN</span> <span class="token number">40</span> <span class="token keyword">THEN</span> salary<span class="token operator">*</span><span class="token number">1.2</span>
<span class="token keyword">WHEN</span> <span class="token number">50</span> <span class="token keyword">THEN</span> salary<span class="token operator">*</span><span class="token number">1.3</span>
<span class="token keyword">ELSE</span> salary
<span class="token keyword">END</span> <span class="token keyword">AS</span> 新工资 <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment">/*
查询员工工资情况
如果工资&gt;20000，显示A级别
如果工资&gt;15000，显示B级别
如果工资&gt;10000，显示C级别
否则，显示D级别
*/</span>
<span class="token keyword">SELECT</span> salary 工资<span class="token punctuation">,</span>
<span class="token keyword">CASE</span>
<span class="token keyword">WHEN</span> salary<span class="token operator">&gt;</span><span class="token number">20000</span> <span class="token keyword">THEN</span> <span class="token string">'A'</span>
<span class="token keyword">WHEN</span> salary<span class="token operator">&gt;</span><span class="token number">15000</span> <span class="token keyword">THEN</span> <span class="token string">'B'</span>
<span class="token keyword">WHEN</span> salary<span class="token operator">&gt;</span><span class="token number">10000</span> <span class="token keyword">THEN</span> <span class="token string">'C'</span>
<span class="token keyword">ELSE</span> <span class="token string">'D'</span>
<span class="token keyword">END</span> <span class="token keyword">AS</span> 工资级别 <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div></li></ul></li></ol> <h3 id="分组函数"><a href="#分组函数" class="header-anchor">#</a> 分组函数</h3> <p><strong>分组函数</strong>用作统计使用，又称为聚合函数或统计函数或组函数。</p> <p>分组函数常见的有：<code>sum</code>求和、<code>avg</code>平均值、<code>max</code>最大值、<code>min</code>最小值、<code>count</code>计算个数。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># SUM函数：求和。求所有员工工资总和</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># AVG函数：求平均值。求员工工资的平均值</span>
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># MIN函数：求最小值。求员工中工资最小的</span>
<span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># MAX函数：求最大值。求员工中工资最大的</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># COUNT函数：有多少个非空数据行。求有多少员工有工资信息</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>分组函数使用特点：</p> <ol><li><p><code>sum</code>、<code>avg</code>一般用于处理<strong>数值型</strong>；<code>max</code>、<code>min</code>、<code>count</code>可以处理任何类型。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># SUM函数和AVG函数一般处理数值型，处理其他的虽然不报错但没什么意义</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>last_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>hiredate<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>hiredate<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># MIN函数、MAX函数和COUNT函数可以处理任何类型</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>last_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>hiredate<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>hiredate<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># COUNT函数只统计非空的数据</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>分组函数都会忽略 Null 值。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># SUM函数和AVG函数都会忽略null值。null+任何值都是null。平均值实际除以的是35，不包括null行</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">35</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># MAX函数和MIN函数都会忽略null值。不然最大最小值就会有null。</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># COUNT函数只统计非空的数据</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>分组函数可以搭配<code>DISTINCT</code>使用，一般是<code>count</code>函数和<code>DISTINCT</code>搭配使用的多。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 分组函数可搭配DISTINCT使用，主要是count函数搭配它。查询工资有几种</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>统计表的行数，可以用<code>count(*)</code>、<code>count(常量)</code>、<code>count(列名)</code>，其中<code>count(*)</code>用得最多。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 用COUNT统计表的函数，有`count(*)`、`count(常量)`、`count(列名)`三种</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># COUNT(*)表示这一行里只有一列的值不为Null就统计上</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment"># COUNT(1)其实是临时加了一列，然后让这一列所有行的值都为1，并统计总行数</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>和分组函数一同查询的字段有限制（一般是<code>group by</code>后的字段）</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 和分组函数一同查询的字段有限制。这个employee_id查出来就没有意义了</span>
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> employee_id <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol> <h2 id="分组查询"><a href="#分组查询" class="header-anchor">#</a> 分组查询</h2> <p><strong>分组查询</strong>是对表按照某个列进行分组，再对每组的情况进行一个统计（每组的某列的平均值、最大最小值等）。</p> <h3 id="分组查询简单使用"><a href="#分组查询简单使用" class="header-anchor">#</a> 分组查询简单使用</h3> <p>写法：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> 分组函数<span class="token punctuation">,</span> 列（要求出现在<span class="token keyword">group</span> <span class="token keyword">by</span>的后面）
<span class="token keyword">from</span> 表名
【<span class="token keyword">where</span> 筛选条件】
<span class="token keyword">group</span> <span class="token keyword">by</span> 分组的列表
【<span class="token keyword">order</span> <span class="token keyword">by</span> 字句】
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>我们可以看到上面写法中的查询列表是“分组函数”和“列”。这个“列”就是<code>group by</code>后面的字段，表示按照什么字段进行分组；这个“分组函数”就是对组里的什么字段进行一个什么样的统计。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 查询每个工种的最高工资。</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> job_id  <span class="token comment"># 统计每组的最高的salary</span>
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id<span class="token punctuation">;</span>            <span class="token comment"># 按照job_id进行分组</span>
<span class="token comment"># 查询每个位置上的部门个数</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>location_id
<span class="token keyword">FROM</span> departments
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> location_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="添加筛选条件"><a href="#添加筛选条件" class="header-anchor">#</a> 添加筛选条件</h3> <p>分组查询中的筛选条件分为两类：</p> <table><thead><tr><th></th> <th>数据源</th> <th>位置</th> <th>关键字</th></tr></thead> <tbody><tr><td>分组前筛选</td> <td>原始表</td> <td>group by 子句的前面</td> <td>where</td></tr> <tr><td>分组后筛选</td> <td>分组后的结果集</td> <td>group by 子句的后面</td> <td>having</td></tr></tbody></table> <p>使用注意点：</p> <ul><li>分组函数做条件肯定是放在 having 字句中的，也就是“分组后筛选”</li> <li>能用分组前筛选的，就优先考虑使用分组前筛选。</li></ul> <p>添加分组前筛选例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 查询邮箱中包含a字符的，每个部门的平均工资</span>
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> email <span class="token operator">LIKE</span> <span class="token string">'%a%'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">;</span>
<span class="token comment"># 查询有奖金的，每个领导手下员工的最高工资</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>manager_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> manager_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>添加分组后筛选（使用<code>HAVING</code>关键字）例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 查询哪个部门的员工个数&gt;2（分组后的刷选）</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span> department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment"># 查询每个工种有奖金的员工的最高工资&gt;12000的工种编号和最高工资</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> job_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id
<span class="token keyword">HAVING</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">12000</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id=""><a href="#" class="header-anchor">#</a></h3> <h2 id="连接查询"><a href="#连接查询" class="header-anchor">#</a> 连接查询</h2> <h2 id="子查询"><a href="#子查询" class="header-anchor">#</a> 子查询</h2> <h2 id="分页查询"><a href="#分页查询" class="header-anchor">#</a> 分页查询</h2> <h2 id="联合查询"><a href="#联合查询" class="header-anchor">#</a> 联合查询</h2> <h2 id="查询总结"><a href="#查询总结" class="header-anchor">#</a> 查询总结</h2></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main> <div class="right-sidebar-wrapper right-sidebar-hidden"><aside class="right-sidebar"><div><div class="title">本文目录</div><h1><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#数据查询语言-dql" title="数据查询语言 DQL">数据查询语言 DQL</a></h1><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#基础查询" title="基础查询">基础查询</a></h2><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#条件查询" title="条件查询">条件查询</a></h2><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#普通条件查询" title="普通条件查询">普通条件查询</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#模糊查询" title="模糊查询">模糊查询</a></h3><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#排序查询" title="排序查询">排序查询</a></h2><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#常见函数" title="常见函数">常见函数</a></h2><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#单行函数" title="单行函数">单行函数</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#分组函数" title="分组函数">分组函数</a></h3><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#分组查询" title="分组查询">分组查询</a></h2><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#分组查询简单使用" title="分组查询简单使用">分组查询简单使用</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#添加筛选条件" title="添加筛选条件">添加筛选条件</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#" title=""></a></h3><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#连接查询" title="连接查询">连接查询</a></h2><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#子查询" title="子查询">子查询</a></h2><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#分页查询" title="分页查询">分页查询</a></h2><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#联合查询" title="联合查询">联合查询</a></h2><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0mysql/2.%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80DQL.html#查询总结" title="查询总结">查询总结</a></h2></div></aside> <div class="sidebar-toggle" data-v-10bfdc0c><div class="sidebar-toggle-button" data-v-10bfdc0c><span data-v-10bfdc0c></span><span data-v-10bfdc0c></span><span data-v-10bfdc0c></span></div></div></div></div><div class="global-ui"><!----></div></div>
    <script src="/blog-vuepress/assets/js/app.34680ebc.js" defer></script><script src="/blog-vuepress/assets/js/2.1e7adb41.js" defer></script><script src="/blog-vuepress/assets/js/96.beed2305.js" defer></script><script src="/blog-vuepress/assets/js/38.cec9a03e.js" defer></script>
  </body>
</html>
