<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>3.文件和目录操作 | Liawn&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <meta charset="UTF-8">
  <link rel="icon" href="/blog-vuepress/favicon.ico">
  <link rel="manifest" href="/blog-vuepress/manifest.json">
  <meta name="theme-color" content="#ffffff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/blog-vuepress/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/blog-vuepress/safari-pinned-tab.svg" color="#ffffff">
  <meta name="msapplication-TileImage" content="/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    <meta name="description" content="用vuepress搭建的个人博客">
    <meta charset="UTF-8">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/blog-vuepress/assets/css/0.styles.2f620dda.css" as="style"><link rel="preload" href="/blog-vuepress/assets/js/app.34680ebc.js" as="script"><link rel="preload" href="/blog-vuepress/assets/js/2.1e7adb41.js" as="script"><link rel="preload" href="/blog-vuepress/assets/js/100.311567ba.js" as="script"><link rel="preload" href="/blog-vuepress/assets/js/38.cec9a03e.js" as="script"><link rel="prefetch" href="/blog-vuepress/assets/js/10.1e723314.js"><link rel="prefetch" href="/blog-vuepress/assets/js/101.ef72e26e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/102.c3759919.js"><link rel="prefetch" href="/blog-vuepress/assets/js/103.98e877a9.js"><link rel="prefetch" href="/blog-vuepress/assets/js/104.e27de6a0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/105.3a1ef548.js"><link rel="prefetch" href="/blog-vuepress/assets/js/106.59ee0f92.js"><link rel="prefetch" href="/blog-vuepress/assets/js/107.e68abe87.js"><link rel="prefetch" href="/blog-vuepress/assets/js/108.8fcda232.js"><link rel="prefetch" href="/blog-vuepress/assets/js/109.422d008d.js"><link rel="prefetch" href="/blog-vuepress/assets/js/11.58bde1dd.js"><link rel="prefetch" href="/blog-vuepress/assets/js/110.f713fc26.js"><link rel="prefetch" href="/blog-vuepress/assets/js/111.58efaae4.js"><link rel="prefetch" href="/blog-vuepress/assets/js/112.c6bdfbe0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/113.8dbd693e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/114.8a85e37a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/115.54a6972e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/116.56b2d8b8.js"><link rel="prefetch" href="/blog-vuepress/assets/js/117.11470546.js"><link rel="prefetch" href="/blog-vuepress/assets/js/118.1a39e213.js"><link rel="prefetch" href="/blog-vuepress/assets/js/119.41f15fbd.js"><link rel="prefetch" href="/blog-vuepress/assets/js/12.613505ee.js"><link rel="prefetch" href="/blog-vuepress/assets/js/120.9ac14643.js"><link rel="prefetch" href="/blog-vuepress/assets/js/121.83954220.js"><link rel="prefetch" href="/blog-vuepress/assets/js/122.bef8fade.js"><link rel="prefetch" href="/blog-vuepress/assets/js/123.25446ff9.js"><link rel="prefetch" href="/blog-vuepress/assets/js/124.6acf9e60.js"><link rel="prefetch" href="/blog-vuepress/assets/js/125.42c6fb5e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/126.b9b98daa.js"><link rel="prefetch" href="/blog-vuepress/assets/js/127.382eea79.js"><link rel="prefetch" href="/blog-vuepress/assets/js/13.75740994.js"><link rel="prefetch" href="/blog-vuepress/assets/js/14.febc6ec1.js"><link rel="prefetch" href="/blog-vuepress/assets/js/15.6e16849c.js"><link rel="prefetch" href="/blog-vuepress/assets/js/16.70db9d99.js"><link rel="prefetch" href="/blog-vuepress/assets/js/17.f098e403.js"><link rel="prefetch" href="/blog-vuepress/assets/js/18.21ad25ae.js"><link rel="prefetch" href="/blog-vuepress/assets/js/19.4b561714.js"><link rel="prefetch" href="/blog-vuepress/assets/js/20.8dae8a78.js"><link rel="prefetch" href="/blog-vuepress/assets/js/21.7d09e2a3.js"><link rel="prefetch" href="/blog-vuepress/assets/js/22.7838f809.js"><link rel="prefetch" href="/blog-vuepress/assets/js/23.2444198c.js"><link rel="prefetch" href="/blog-vuepress/assets/js/24.099866db.js"><link rel="prefetch" href="/blog-vuepress/assets/js/25.d059d716.js"><link rel="prefetch" href="/blog-vuepress/assets/js/26.243af3f2.js"><link rel="prefetch" href="/blog-vuepress/assets/js/27.97e455c9.js"><link rel="prefetch" href="/blog-vuepress/assets/js/28.97ce9b54.js"><link rel="prefetch" href="/blog-vuepress/assets/js/29.392d550e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/3.49db6791.js"><link rel="prefetch" href="/blog-vuepress/assets/js/30.9161535d.js"><link rel="prefetch" href="/blog-vuepress/assets/js/31.46b99656.js"><link rel="prefetch" href="/blog-vuepress/assets/js/32.c2fd0854.js"><link rel="prefetch" href="/blog-vuepress/assets/js/33.3080b8a5.js"><link rel="prefetch" href="/blog-vuepress/assets/js/34.e15baec0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/35.f144a7bd.js"><link rel="prefetch" href="/blog-vuepress/assets/js/36.e1175535.js"><link rel="prefetch" href="/blog-vuepress/assets/js/37.72ec58bc.js"><link rel="prefetch" href="/blog-vuepress/assets/js/39.fc6f4606.js"><link rel="prefetch" href="/blog-vuepress/assets/js/4.eca03551.js"><link rel="prefetch" href="/blog-vuepress/assets/js/40.b74ded47.js"><link rel="prefetch" href="/blog-vuepress/assets/js/41.cee8cec1.js"><link rel="prefetch" href="/blog-vuepress/assets/js/42.7f4e1373.js"><link rel="prefetch" href="/blog-vuepress/assets/js/43.10c6d899.js"><link rel="prefetch" href="/blog-vuepress/assets/js/44.4f190d43.js"><link rel="prefetch" href="/blog-vuepress/assets/js/45.5c2f36ae.js"><link rel="prefetch" href="/blog-vuepress/assets/js/46.9a5337f5.js"><link rel="prefetch" href="/blog-vuepress/assets/js/47.161b10c1.js"><link rel="prefetch" href="/blog-vuepress/assets/js/48.93192e20.js"><link rel="prefetch" href="/blog-vuepress/assets/js/49.72ba1cc4.js"><link rel="prefetch" href="/blog-vuepress/assets/js/5.aacc9c46.js"><link rel="prefetch" href="/blog-vuepress/assets/js/50.bfc0c26a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/51.05bbb696.js"><link rel="prefetch" href="/blog-vuepress/assets/js/52.84b5a67c.js"><link rel="prefetch" href="/blog-vuepress/assets/js/53.220715ca.js"><link rel="prefetch" href="/blog-vuepress/assets/js/54.d433d73f.js"><link rel="prefetch" href="/blog-vuepress/assets/js/55.f8221d0f.js"><link rel="prefetch" href="/blog-vuepress/assets/js/56.2ec79246.js"><link rel="prefetch" href="/blog-vuepress/assets/js/57.01a3b85e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/58.9015a667.js"><link rel="prefetch" href="/blog-vuepress/assets/js/59.73311086.js"><link rel="prefetch" href="/blog-vuepress/assets/js/6.0c335663.js"><link rel="prefetch" href="/blog-vuepress/assets/js/60.976cf8cc.js"><link rel="prefetch" href="/blog-vuepress/assets/js/61.4a1c95f1.js"><link rel="prefetch" href="/blog-vuepress/assets/js/62.865f814a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/63.0d882dec.js"><link rel="prefetch" href="/blog-vuepress/assets/js/64.c74f770a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/65.0d5262a8.js"><link rel="prefetch" href="/blog-vuepress/assets/js/66.1cd8fc00.js"><link rel="prefetch" href="/blog-vuepress/assets/js/67.a73db0e8.js"><link rel="prefetch" href="/blog-vuepress/assets/js/68.2fe7b184.js"><link rel="prefetch" href="/blog-vuepress/assets/js/69.763746bf.js"><link rel="prefetch" href="/blog-vuepress/assets/js/7.09a81cb8.js"><link rel="prefetch" href="/blog-vuepress/assets/js/70.2f10d153.js"><link rel="prefetch" href="/blog-vuepress/assets/js/71.f0476a16.js"><link rel="prefetch" href="/blog-vuepress/assets/js/72.b3aa24c4.js"><link rel="prefetch" href="/blog-vuepress/assets/js/73.d90b4378.js"><link rel="prefetch" href="/blog-vuepress/assets/js/74.5f3afc25.js"><link rel="prefetch" href="/blog-vuepress/assets/js/75.610a9393.js"><link rel="prefetch" href="/blog-vuepress/assets/js/76.397a07d0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/77.a7a16098.js"><link rel="prefetch" href="/blog-vuepress/assets/js/78.0a76e3c0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/79.d9bf3b6d.js"><link rel="prefetch" href="/blog-vuepress/assets/js/8.7a4382cf.js"><link rel="prefetch" href="/blog-vuepress/assets/js/80.6653af85.js"><link rel="prefetch" href="/blog-vuepress/assets/js/81.7bfd7632.js"><link rel="prefetch" href="/blog-vuepress/assets/js/82.e5ec57b6.js"><link rel="prefetch" href="/blog-vuepress/assets/js/83.7728c890.js"><link rel="prefetch" href="/blog-vuepress/assets/js/84.dd67c36e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/85.7387a0e5.js"><link rel="prefetch" href="/blog-vuepress/assets/js/86.bbfe7f7f.js"><link rel="prefetch" href="/blog-vuepress/assets/js/87.2de3f2a7.js"><link rel="prefetch" href="/blog-vuepress/assets/js/88.809122f0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/89.321e8e47.js"><link rel="prefetch" href="/blog-vuepress/assets/js/9.26929067.js"><link rel="prefetch" href="/blog-vuepress/assets/js/90.5ce6c826.js"><link rel="prefetch" href="/blog-vuepress/assets/js/91.075154c5.js"><link rel="prefetch" href="/blog-vuepress/assets/js/92.11b94685.js"><link rel="prefetch" href="/blog-vuepress/assets/js/93.a9d4d5f0.js"><link rel="prefetch" href="/blog-vuepress/assets/js/94.306ece7e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/95.817525f6.js"><link rel="prefetch" href="/blog-vuepress/assets/js/96.beed2305.js"><link rel="prefetch" href="/blog-vuepress/assets/js/97.b4c539f2.js"><link rel="prefetch" href="/blog-vuepress/assets/js/98.8e445314.js"><link rel="prefetch" href="/blog-vuepress/assets/js/99.558669ea.js">
    <link rel="stylesheet" href="/blog-vuepress/assets/css/0.styles.2f620dda.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><a href="/blog-vuepress/" class="home-link router-link-active"><!----> <span class="site-name">Liawn's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog-vuepress/book-web/" class="nav-link router-link-active">
  Web
</a></div><div class="nav-item"><a href="/blog-vuepress/book-sketches/" class="nav-link">
  生活
</a></div> <!----></nav></div></header> <div class="sidebar-wrapper sidebar-hidden"><aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog-vuepress/book-web/" class="nav-link router-link-active">
  Web
</a></div><div class="nav-item"><a href="/blog-vuepress/book-sketches/" class="nav-link">
  生活
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span>web前端</span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/html、css、js、ts/学习JavaScript/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习JavaScript</span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/html、css、js、ts/学习CSS/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习CSS</span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/html、css、js、ts/学习TypeScript/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习TypeScript</span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/web前端js框架/学习Vue/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习Vue</span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/web前端js框架/学习React/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习React</span></a> <!----></section></li><li><a href="/blog-vuepress/book-web/web前端js框架/学习jQuery.html" class="sidebar-link">jQueryNote</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/LayaBox游戏引擎/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>H5游戏引擎Laya</span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span>常用工具</span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog-vuepress/book-web/常用工具/Npm的使用.html" class="sidebar-link">Npm 的使用</a></li><li><a href="/blog-vuepress/book-web/常用工具/Git的使用.html" class="sidebar-link">Git 的使用</a></li><li><a href="/blog-vuepress/book-web/常用工具/webpack的使用.html" class="sidebar-link">webpack 的使用</a></li><li><a href="/blog-vuepress/book-web/常用工具/VSCode的使用.html" class="sidebar-link">VSCode 的使用</a></li><li><a href="/blog-vuepress/book-web/常用工具/Chrome的使用.html" class="sidebar-link">Chrome 的使用</a></li><li><a href="/blog-vuepress/book-web/常用工具/使用vuepress写blog.html" class="sidebar-link">使用 vuepress 写 blog</a></li><li><a href="/blog-vuepress/book-web/常用工具/使用docsify写blog.html" class="sidebar-link">使用 docsify 写 blog</a></li><li><a href="/blog-vuepress/book-web/常用工具/使用gitbook写blog.html" class="sidebar-link">使用 gitbook 写 blog</a></li><li><a href="/blog-vuepress/book-web/web前端测试与调试/基于mocha+chai的单元测试.html" class="sidebar-link">使用 mocha+chai 进行单元测试</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><!----> <span>Web后端</span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/web后端/学习node.js/" class="sidebar-heading clickable open"><span class="arrow down"></span> <span>学习node.js</span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog-vuepress/book-web/web后端/学习node.js/1.globals和模块.html" class="sidebar-link">1.globals和模块</a></li><li><a href="/blog-vuepress/book-web/web后端/学习node.js/2.Buffer缓存区和path路径.html" class="sidebar-link">2.Buffer缓存区和path路径</a></li><li><a href="/blog-vuepress/book-web/web后端/学习node.js/3.文件和目录操作.html" class="active sidebar-link">3.文件和目录操作</a></li><li><a href="/blog-vuepress/book-web/web后端/学习node.js/4.http传输相关.html" class="sidebar-link">4.http传输相关</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/web后端/学习python/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>学习python</span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span>简单项目实践</span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/项目/react+express+ts写爬虫/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>react+express+ts写爬虫</span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span>数据结构与算法</span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/blog-vuepress/book-web/数据结构与算法/" class="sidebar-heading clickable"><span class="arrow right"></span> <span>数据结构与算法ts版</span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span>面试准备</span></p> <!----></section></li></ul> </aside> <div class="sidebar-toggle" data-v-10bfdc0c><div class="sidebar-toggle-button" data-v-10bfdc0c><span data-v-10bfdc0c></span><span data-v-10bfdc0c></span><span data-v-10bfdc0c></span></div></div></div> <main class="page sidebar-hidden right-sidebar-hidden"> <div class="theme-default-content content__default"><h1 id="文件和目录操作"><a href="#文件和目录操作" class="header-anchor">#</a> 文件和目录操作</h1> <h2 id="什么是-fs-文件系统模块"><a href="#什么是-fs-文件系统模块" class="header-anchor">#</a> 什么是 fs 文件系统模块</h2> <p>fs 模块是 Node.js 官方提供的、用来操作文件的模块。它提供了一系列的方法和属性，用来满足用户对文件的操作需求。具体 API 可以看<a href="https://nodejs.org/docs/latest-v14.x/api/fs.html" target="_blank" rel="noopener noreferrer">这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。所有文件系统操作都具有<strong>同步</strong>、<strong>回调</strong>和<strong>基于 promise</strong>的形式。</p> <ul><li><strong>回调的 API</strong>和<strong>Promise API</strong>，使用底层的 Node.js 线程池在事件循环线程之外执行文件系统操作。 这些操作不是同步的也不是线程安全的。 对同一文件执行多个并发修改时必须小心，否则可能会损坏数据。</li> <li><strong>同步的 API</strong>同步地执行所有操作，阻塞事件循环（和进一步的 JavaScript 执行），直到操作完成或失败。</li> <li>当达到最佳性能时（无论是在执行时间还是在内存分配方面），fs 模块基于回调的 API 版本都比使用 promise API 更好（比同步也要快性能好）。但<strong>promise API</strong>可以解决<strong>回调地狱</strong>的问题。</li></ul> <p><strong>基于 promise</strong>：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> unlink <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;fs/promises&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string">&quot;/tmp/hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;successfully deleted /tmp/hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;there was an error:&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>回调形式</strong>：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> unlink <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span>

<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string">&quot;/tmp/hello&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;successfully deleted /tmp/hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>同步形式</strong>：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> unlinkSync <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token function">unlinkSync</span><span class="token punctuation">(</span><span class="token string">&quot;/tmp/hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;successfully deleted /tmp/hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 处理错误</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="文件操作"><a href="#文件操作" class="header-anchor">#</a> 文件操作</h2> <h3 id="fs-open"><a href="#fs-open" class="header-anchor">#</a> fs.open()</h3> <p><code>fs.open(path, flags[, mode], callback)</code>方法用于打开文件</p> <ul><li><code>path</code>，必选参数，表示文件的路径。</li> <li><code>flags</code>，文件打开的行为。请参阅<a href="/blog-vuepress/book-web/web后端/学习node.js/3.文件和目录操作.html#文件系统标志">文件系统标志</a>。</li> <li><code>mode</code>，可选参数，设置文件模式(权限)，文件创建默认权限为 0666(可读，可写)。请参阅<a href="/blog-vuepress/book-web/web后端/学习node.js/3.文件和目录操作.html#文件的模式">文件的模式</a></li> <li><code>callback</code>，回调函数，带有两个参数如：<code>callback(err, fd)</code>。</li></ul> <h3 id="fs-close"><a href="#fs-close" class="header-anchor">#</a> fs.close()</h3> <p><code>fs.close(fd, callback)</code>方法用于关闭文件</p> <ul><li><code>fd</code>：通过<code>fs.open()</code>方法返回的文件描述符。</li> <li><code>callback</code>：回调函数。</li></ul> <h3 id="fs-read"><a href="#fs-read" class="header-anchor">#</a> fs.read()</h3> <p><code>fs.read(fd, buffer, offset, length, position, callback)</code>从<code>fd</code>指定的文件中读取数据</p> <ul><li><code>fd</code>：通过<code>fs.open()</code>方法返回的文件描述符。</li> <li><code>buffer</code>：数据将写入的缓冲区。 默认值: <code>Buffer.alloc(16384)</code></li> <li><code>offset</code>：要写入数据的 buffer 中的位置。 默认值: <code>0</code></li> <li><code>length</code>：读取的字节数。 默认值: <code>buffer.byteLength</code></li> <li><code>position</code>：指定从文件中开始读取的位置。 如果 position 为 <code>null</code> 或 <code>-1</code> ，则将从当前文件位置读取数据，并更新文件位置。 如果 position 是整数，则文件位置将保持不变。</li> <li><code>callback</code>：回调函数，有三个参数<code>callback(err, bytesRead, buffer)</code>。其中<code>err</code>为错误信息， <code>bytesRead</code>表示读取的字节数，<code>buffer</code>为缓冲区对象。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> open<span class="token punctuation">,</span> close <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span>

<span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;myfile&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wx&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fd</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">&quot;EEXIST&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;myfile already exists&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> buf <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>

  fs<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> bytesRead<span class="token punctuation">,</span> buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;读取到的字节数：&quot;</span><span class="token punctuation">,</span> bytesRead<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;读取到的数据是：&quot;</span><span class="token punctuation">,</span> buffer<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="fs-readfile"><a href="#fs-readfile" class="header-anchor">#</a> fs.readFile()</h3> <p><code>fs.readFile(path[, options], callback)</code>方法，可以读取指定文件中的内容</p> <ul><li><code>path</code>，必选参数，表示文件的路径</li> <li><code>options</code>，可选参数，表示以什么编码格式来读取文件。如果不指定这个参数，默认会将读取到的数据放到 Buffer 中</li> <li><code>callback</code>，必选参数，文件读取完成后，通过回调函数拿到读取的结果</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// err为报错信息，data为文件内容</span>
fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">&quot;/Users/joe/test.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;utf8&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">文件读取失败：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">文件读取成功：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>fs.readFile()</code>方法每次一块地异步读取文件内容到内存中，允许事件循环在每个块之间转换。 这允许读取操作对可能使用底层 libuv 线程池的其他活动的影响较小，但意味着将完整文件读入内存需要更长的时间。对于需要尽可能快地读取文件内容的应用程序，最好直接使用<a href="/blog-vuepress/book-web/web后端/学习node.js/3.文件和目录操作.html#fs-read"><code>fs.read()</code></a>并让应用程序代码管理读取文件本身的全部内容。当然也可以使用<a href="/blog-vuepress/book-web/web后端/学习node.js/3.文件和目录操作.html#fs-createreadstream"><code>fs.createReadStream()</code></a>以流的形式读取文件。</p> <h3 id="fs-write"><a href="#fs-write" class="header-anchor">#</a> fs.write()</h3> <p><code>fs.write(fd, buffer[, offset[, length[, position]]], callback)</code>将 buffer 缓冲区里的数据写入 fd 指定的文件。</p> <ul><li><code>fd</code>：通过<code>fs.open()</code>方法返回的文件描述符。</li> <li><code>buffer</code>：数据源，是一个缓冲区。</li> <li><code>offset</code>：确定要写入的缓冲区部分</li> <li><code>length</code>：是整数，指定要写入的字节数。</li> <li><code>position</code>：指从文件开头数据应被写入的偏移量。 如果 typeof position !== 'number'，则数据将写入当前位置。</li> <li><code>callback</code>：回调函数，有三个参数<code>callback(err, bytesWritten, buffer)</code>。其中<code>err</code>为错误信息， <code>bytesWritten</code>表示写入的字节数，<code>buffer</code>为缓冲区对象。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> open<span class="token punctuation">,</span> close <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span>

<span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;myfile&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wx&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fd</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">&quot;EEXIST&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;myfile already exists&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> buf <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>

  fs<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> bytesWritten<span class="token punctuation">,</span> buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bytesWritten<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buffer<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p><code>fs.write(fd, string[, position[, encoding]], callback)</code>将 string 写入 fd 指定的文件。</p> <ul><li><code>fd</code>：通过<code>fs.open()</code>方法返回的文件描述符。</li> <li><code>string</code>：数据源，是一个字符串。</li> <li><code>position</code>指从文件开头数据应被写入的偏移量。 如果 typeof position !== 'number'，则数据将写入当前位置。</li> <li><code>encoding</code>是预期的字符串编码。</li> <li><code>callback</code>：回调函数，有三个参数<code>callback(err, written, string)</code>。其中<code>err</code>为错误信息， <code>written</code>表示写入的字节数。</li></ul> <p><code>fs.write()</code>在同一个文件上多次使用而不等待回调是不安全的。对于这种情况，推荐使用<code>fs.createWriteStream()</code>（对于性能敏感的代码也推荐使用它）。</p> <h3 id="fs-writefile"><a href="#fs-writefile" class="header-anchor">#</a> fs.writeFile()</h3> <p><code>fs.writeFile(file, data[, options], callback)</code>方法，可以向指定的文件中写入内容。</p> <ul><li><code>file</code>，必选参数，需要指定一个文件路径的字符串，表示文件的存放路径</li> <li><code>data</code>，必选参数，表示要写入的内容</li> <li><code>options</code>，该参数是一个对象，包含<code>{encoding, mode, flag}</code>。默认 encoding 为<code>'utf8'</code>, mode 为<code>0666</code>，<code>flag</code>为<code>'w'</code></li> <li><code>callback</code>，必选参数，文件写入完成后的回调参数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">&quot;message.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hello Node.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;utf8&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">文件写入失败：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">文件写入成功</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>fs.writeFile()</code>在同一个文件上多次使用而不等待回调是不安全的。对于这种情况，推荐使用<a href="/blog-vuepress/book-web/web后端/学习node.js/3.文件和目录操作.html#fs-createwritestream"><code>fs.createWriteStream()</code></a>（对于性能敏感的代码也推荐使用它）。</p> <h3 id="fs-stat"><a href="#fs-stat" class="header-anchor">#</a> fs.stat()</h3> <p><code>fs.stat(path[, options], callback)</code>查看文件状态</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>__filename<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// birthtime文件创建时间。mtime文件内容发生变化，文件的修改时间</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stats<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;当前路径对应的是一个文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;当前路径对应的是一个文件夹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>不推荐在调用<code>fs.open()</code>、<code>fs.readFile()</code>或<code>fs.writeFile()</code>之前使用<code>fs.stat()</code>检查文件是否存在。 而是，用户代码应该<strong>直接打开/读取/写入文件</strong>，并在文件不可用时处理引发的错误</p> <p>stats 类中的方法有：</p> <table><thead><tr><th>方法</th> <th>描述</th></tr></thead> <tbody><tr><td>stats.isFile()</td> <td>如果是文件返回 true，否则返回 false。</td></tr> <tr><td>stats.isDirectory()</td> <td>如果是目录返回 true，否则返回 false。</td></tr> <tr><td>stats.isBlockDevice()</td> <td>如果是块设备返回 true，否则返回 false。</td></tr> <tr><td>stats.isCharacterDevice()</td> <td>如果是字符设备返回 true，否则返回 false。</td></tr> <tr><td>stats.isSymbolicLink()</td> <td>如果是软链接返回 true，否则返回 false。</td></tr> <tr><td>stats.isFIFO()</td> <td>如果是 FIFO，返回 true，否则返回 false。FIFO 是 UNIX 中的一种特殊类型的命令管道。</td></tr> <tr><td>stats.isSocket()</td> <td>如果是 Socket 返回 true，否则返回 false。</td></tr></tbody></table> <h3 id="fs-access"><a href="#fs-access" class="header-anchor">#</a> fs.access()</h3> <p><code>fs.access(path[, mode], callback)</code>检查文件是否存在而不对其进行操作。mode 参数是可选的整数，指定要执行的可访问性检查，可查阅<a href="/blog-vuepress/book-web/web后端/学习node.js/3.文件和目录操作.html#文件访问的常量">文件访问的常量</a></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> access<span class="token punctuation">,</span> constants <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token string">&quot;package.json&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 检查当前目录中是否存在该文件。</span>
<span class="token function">access</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> constants<span class="token punctuation">.</span><span class="token constant">F_OK</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err <span class="token operator">?</span> <span class="token string">&quot;does not exist&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;exists&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 检查文件是否可读。</span>
<span class="token function">access</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> constants<span class="token punctuation">.</span><span class="token constant">R_OK</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err <span class="token operator">?</span> <span class="token string">&quot;is not readable&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;is readable&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 检查文件是否可写。</span>
<span class="token function">access</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> constants<span class="token punctuation">.</span><span class="token constant">W_OK</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err <span class="token operator">?</span> <span class="token string">&quot;is not writable&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;is writable&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 检查当前目录中是否存在文件，是否可写。</span>
<span class="token function">access</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> constants<span class="token punctuation">.</span><span class="token constant">F_OK</span> <span class="token operator">|</span> constants<span class="token punctuation">.</span><span class="token constant">W_OK</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">&quot;ENOENT&quot;</span> <span class="token operator">?</span> <span class="token string">&quot;does not exist&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;is read-only&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> exists, and it is writable</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>在调用<code>fs.open()</code>、<code>fs.readFile()</code>或<code>fs.writeFile()</code>之前，不要使用<code>fs.access()</code>检查文件的可访问性。 这样做会引入竞争条件，因为其他进程可能会在两次调用之间更改文件的状态。 而是，用户代码应<strong>直接打开/读取/写入文件</strong>，并处理无法访问文件时引发的错误。</p> <p>“文件写入”的一种写法：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> open<span class="token punctuation">,</span> close <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span>

<span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;myfile&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wx&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fd</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">&quot;EEXIST&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;myfile already exists&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token function">writeMyData</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>“文件读取”的一种写法：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> open<span class="token punctuation">,</span> close <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span>

<span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;myfile&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fd</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">&quot;ENOENT&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;myfile does not exist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token function">readMyData</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="fs-appendfile"><a href="#fs-appendfile" class="header-anchor">#</a> fs.appendFile()</h3> <p><code>fs.appendFile(path, data[, options], callback)</code>将数据追加到文件，如果该文件尚不存在，则创建该文件。 data 可以是字符串或 Buffer。</p> <ul><li><code>options</code> <ul><li><code>encoding</code>：默认值: <code>'utf8'</code></li> <li><code>mode</code>：默认值: <code>0o666</code>，请参阅<a href="/blog-vuepress/book-web/web后端/学习node.js/3.文件和目录操作.html#文件的模式">文件的模式</a></li> <li><code>flag</code>： 默认值: <code>'a'</code>，请参阅<a href="/blog-vuepress/book-web/web后端/学习node.js/3.文件和目录操作.html#文件系统标志">文件系统标志</a>。</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> appendFile <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span>

<span class="token function">appendFile</span><span class="token punctuation">(</span><span class="token string">&quot;message.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;data to append&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'The &quot;data to append&quot; was appended to file!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> open<span class="token punctuation">,</span> close<span class="token punctuation">,</span> appendFile <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">closeFd</span><span class="token punctuation">(</span><span class="token parameter">fd</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;message.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fd</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token function">appendFile</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token string">&quot;data to append&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;utf8&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">closeFd</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">closeFd</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="fs-createreadstream"><a href="#fs-createreadstream" class="header-anchor">#</a> fs.createReadStream()</h3> <p><code>fs.createReadStream(path[, options])</code></p> <ul><li>options
<ul><li>flags：默认值<code>'r'</code>。请参阅<a href="/blog-vuepress/book-web/web后端/学习node.js/3.文件和目录操作.html#文件系统标志">文件系统标志</a>。</li> <li>encoding：默认值<code>null</code></li> <li>fd：默认值<code>null</code></li> <li>mode：默认值<code>0o666</code></li> <li>autoClose：默认值<code>true</code></li> <li>emitClose： 默认值<code>true</code></li> <li>start：开始读取的位置</li> <li>end：默认值<code>Infinity</code></li> <li>highWaterMark：默认值 <code>64 * 1024</code></li> <li>fs：默认值 null</li></ul></li></ul> <h3 id="fs-createwritestream"><a href="#fs-createwritestream" class="header-anchor">#</a> fs.createWriteStream()</h3> <h2 id="文件的模式"><a href="#文件的模式" class="header-anchor">#</a> 文件的模式</h2> <p>mode 参数是使用以下常量的逻辑或创建的数字位掩码：</p> <table><thead><tr><th>常量</th> <th>八进制</th> <th>描述</th></tr></thead> <tbody><tr><td>fs.constants.S_IRUSR</td> <td>0o400</td> <td>所有者可读取</td></tr> <tr><td>fs.constants.S_IWUSR</td> <td>0o200</td> <td>所有者可写入</td></tr> <tr><td>fs.constants.S_IXUSR</td> <td>0o100</td> <td>所有者可执行/搜索</td></tr> <tr><td>fs.constants.S_IRGRP</td> <td>0o40</td> <td>群组可读取</td></tr> <tr><td>fs.constants.S_IWGRP</td> <td>0o20</td> <td>群组可写入</td></tr> <tr><td>fs.constants.S_IXGRP</td> <td>0o10</td> <td>群组可执行/搜索</td></tr> <tr><td>fs.constants.S_IROTH</td> <td>0o4</td> <td>其他人可读取</td></tr> <tr><td>fs.constants.S_IWOTH</td> <td>0o2</td> <td>其他人可写入</td></tr> <tr><td>fs.constants.S_IXOTH</td> <td>0o1</td> <td>其他人可执行/搜索</td></tr></tbody></table> <p>构建 mode 的一种更简单的方法是使用三个八进制数字的序列（例如 765）。 <strong>最左边</strong>的数字（示例中的 7）指定<strong>文件所有者</strong>的权限。 <strong>中间</strong>的数字（示例中的 6）指定<strong>群组</strong>的权限。 <strong>最右边</strong>的数字（示例中的 5）指定<strong>其他人</strong>的权限。</p> <table><thead><tr><th>数值</th> <th>描述</th></tr></thead> <tbody><tr><td>7</td> <td>可读、可写和可执行</td></tr> <tr><td>6</td> <td>可读和可写</td></tr> <tr><td>5</td> <td>可读和可执行</td></tr> <tr><td>4</td> <td>只读</td></tr> <tr><td>3</td> <td>可写和可执行</td></tr> <tr><td>2</td> <td>只写</td></tr> <tr><td>1</td> <td>只可执行</td></tr> <tr><td>0</td> <td>无权限</td></tr></tbody></table> <p>例如，八进制值 0o765 表示：</p> <ul><li>所有者可以读取、写入和执行文件。</li> <li>群组可以读取和写入文件。</li> <li>其他人可以读取和执行文件。</li></ul> <p>在需要文件模式的地方使用原始数字时，任何大于 0o777 的值都可能导致特定于平台的行为不支持一致工作。 因此，像 S_ISVTX、S_ISGID 或 S_ISUID 这样的常量不会在 fs.constants 中暴露。</p> <h2 id="文件系统标志"><a href="#文件系统标志" class="header-anchor">#</a> 文件系统标志</h2> <p>以下标志在 flag 选项接受字符串的任何地方可用。</p> <ul><li><code>'a'</code>: 打开文件进行追加。 如果文件不存在，则创建该文件。</li> <li><code>'ax'</code>: 类似于<code>'a'</code>但如果路径存在则失败。</li> <li><code>'a+'</code>: 打开文件进行读取和追加。 如果文件不存在，则创建该文件。</li> <li><code>'ax+'</code>: 类似于<code>'a+'</code>但如果路径存在则失败。</li> <li><code>'as'</code>: 以同步模式打开文件进行追加。 如果文件不存在，则创建该文件。</li> <li><code>'as+'</code>: 以同步模式打开文件进行读取和追加。 如果文件不存在，则创建该文件。</li> <li><code>'r'</code>: 打开文件进行读取。 如果文件不存在，则会发生异常。</li> <li><code>'r+'</code>: 打开文件进行读写。 如果文件不存在，则会发生异常。</li> <li><code>'rs+'</code>: 以同步模式打开文件进行读写。 指示操作系统绕过本地文件系统缓存。这主要用于在 NFS 挂载上打开文件，因为它允许跳过可能过时的本地缓存。 它对 I/O 性能有非常实际的影响，因此除非需要，否则不建议使用此标志。这不会将<code>fs.open()</code>或<code>fsPromises.open()</code>变成同步阻塞调用。 如果需要同步操作，应该使用类似<code>fs.openSync()</code>的东西。</li> <li><code>'w'</code>: 打开文件进行写入。 创建（如果它不存在）或截断（如果它存在）该文件。</li> <li><code>'wx'</code>: 类似于<code>'w'</code>但如果路径存在则失败。</li> <li><code>'w+'</code>: 打开文件进行读写。 创建（如果它不存在）或截断（如果它存在）该文件。</li> <li><code>'wx+'</code>: 类似于<code>'w+'</code>但如果路径存在则失败。</li></ul> <h2 id="fs-常量"><a href="#fs-常量" class="header-anchor">#</a> FS 常量</h2> <p>以下常量由 fs.constants 导出。并非每个常量都适用于每个操作系统。要使用多个常量，请使用按位或<code>|</code>运算符。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> open<span class="token punctuation">,</span> constants <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">O_RDWR</span><span class="token punctuation">,</span> <span class="token constant">O_CREAT</span><span class="token punctuation">,</span> <span class="token constant">O_EXCL</span> <span class="token punctuation">}</span> <span class="token operator">=</span> constants<span class="token punctuation">;</span>

<span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/my/file&quot;</span><span class="token punctuation">,</span> <span class="token constant">O_RDWR</span> <span class="token operator">|</span> <span class="token constant">O_CREAT</span> <span class="token operator">|</span> <span class="token constant">O_EXCL</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fd</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="文件访问的常量"><a href="#文件访问的常量" class="header-anchor">#</a> 文件访问的常量</h3> <p>以下常量旨在与<code>fs.access()</code>一起使用。</p> <table><thead><tr><th>常量</th> <th>描述</th></tr></thead> <tbody><tr><td>F_OK</td> <td>指示文件对调用进程可见的标志。 这对于确定文件是否存在很有用，但没有说明 rwx 权限。 未指定模式时的默认值。</td></tr> <tr><td>R_OK</td> <td>指示文件可以被调用进程读取的标志。</td></tr> <tr><td>W_OK</td> <td>指示文件可以被调用进程写入的标志。</td></tr> <tr><td>X_OK</td> <td>指示文件可以被调用进程执行的标志。 这在 Windows 上不起作用（行为类似于 fs.constants.F_OK）。</td></tr></tbody></table> <h3 id="文件复制的常量"><a href="#文件复制的常量" class="header-anchor">#</a> 文件复制的常量</h3> <p>以下常量旨在与<code>fs.copyFile()</code>一起使用。</p> <table><thead><tr><th>常量</th> <th>描述</th></tr></thead> <tbody><tr><td>COPYFILE_EXCL</td> <td>如果存在，如果目标路径已经存在，复制操作将失败并显示错误。</td></tr> <tr><td>COPYFILE_FICLONE</td> <td>如果存在，复制操作将尝试创建写时复制引用链接。 如果底层平台不支持写时复制，则使用回退复制机制。</td></tr> <tr><td>COPYFILE_FICLONE_FORCE</td> <td>如果存在，复制操作将尝试创建写时复制引用链接。 如果底层平台不支持写时复制，则操作将失败并显示错误。</td></tr></tbody></table> <h3 id="文件打开的常量"><a href="#文件打开的常量" class="header-anchor">#</a> 文件打开的常量</h3> <p>以下常量旨在与<code>fs.open()</code>一起使用。</p> <table><thead><tr><th>常量</th> <th>描述</th></tr></thead> <tbody><tr><td>O_RDONLY</td> <td>指示打开文件以进行只读访问的标志。</td></tr> <tr><td>O_WRONLY</td> <td>指示打开文件以进行只写访问的标志。</td></tr> <tr><td>O_RDWR</td> <td>指示打开文件以进行读写访问的标志。</td></tr> <tr><td>O_CREAT</td> <td>如果文件不存在则指示创建文件的标志。</td></tr> <tr><td>O_EXCL</td> <td>如果设置了 O_CREAT 标志并且文件已经存在，则指示打开文件应该失败的标志。</td></tr> <tr><td>O_NOCTTY</td> <td>标志表示如果路径标识一个终端设备，打开路径不应导致该终端成为进程的控制终端（如果进程还没有一个）。</td></tr> <tr><td>O_TRUNC</td> <td>标志表示如果文件存在并且是一个普通文件，并且该文件被成功打开以进行写访问，则其长度应被截断为零。</td></tr> <tr><td>O_APPEND</td> <td>指示数据将追加到文件末尾的标志。</td></tr> <tr><td>O_DIRECTORY</td> <td>如果路径不是目录，则表示打开应该失败的标志。</td></tr> <tr><td>O_NOATIME</td> <td>指示对文件系统的读取访问的标志将不再导致与文件关联的 atime 信息的更新。 此标志仅在 Linux 操作系统上可用。</td></tr> <tr><td>O_NOFOLLOW</td> <td>如果路径是符号链接，则表示打开应该失败的标志。</td></tr> <tr><td>O_SYNC</td> <td>指示文件为同步 I/O 打开的标志，写操作等待文件完整性。</td></tr> <tr><td>O_DSYNC</td> <td>指示文件为同步 I/O 打开的标志，写操作等待数据完整性。</td></tr> <tr><td>O_SYMLINK</td> <td>指示打开符号链接本身而不是它指向的资源的标志。</td></tr> <tr><td>O_DIRECT</td> <td>设置后，将尝试最小化文件 I/O 的缓存影响。</td></tr> <tr><td>O_NONBLOCK</td> <td>指示在可能的情况下以非阻塞模式打开文件的标志。</td></tr> <tr><td>UV_FS_O_FILEMAP</td> <td>设置后，将使用内存文件映射来访问文件。 此标志仅在 Windows 操作系统上可用。 在其他操作系统上，此标志被忽略。</td></tr></tbody></table> <h3 id="文件类型的常量"><a href="#文件类型的常量" class="header-anchor">#</a> 文件类型的常量</h3> <p>以下常量旨在与<code>fs.Stats</code>对象的 mode 属性一起使用，以确定文件的类型。</p> <table><thead><tr><th>常量</th> <th>描述</th></tr></thead> <tbody><tr><td>S_IFMT</td> <td>用于提取文件类型代码的位掩码。</td></tr> <tr><td>S_IFREG</td> <td>常规文件的文件类型常量。</td></tr> <tr><td>S_IFDIR</td> <td>目录的文件类型常量。</td></tr> <tr><td>S_IFCHR</td> <td>面向字符的设备文件的文件类型常量。</td></tr> <tr><td>S_IFBLK</td> <td>面向块的设备文件的文件类型常量。</td></tr> <tr><td>S_IFIFO</td> <td>FIFO/管道的文件类型常量。</td></tr> <tr><td>S_IFLNK</td> <td>符号链接的文件类型常量。</td></tr> <tr><td>S_IFSOCK</td> <td>套接字的文件类型常量。</td></tr></tbody></table> <h3 id="文件模式的常量"><a href="#文件模式的常量" class="header-anchor">#</a> 文件模式的常量</h3> <p>以下常量旨在与<code>fs.Stats</code>对象的 mode 属性一起使用，以确定文件的访问权限。</p> <table><thead><tr><th>常量</th> <th>描述</th></tr></thead> <tbody><tr><td>S_IRWXU</td> <td>文件模式指示所有者可读、可写和可执行。</td></tr> <tr><td>S_IRUSR</td> <td>文件模式指示所有者可读。</td></tr> <tr><td>S_IWUSR</td> <td>文件模式指示所有者可写。</td></tr> <tr><td>S_IXUSR</td> <td>文件模式指示所有者可执行。</td></tr> <tr><td>S_IRWXG</td> <td>文件模式指示群组可读、可写和可执行。</td></tr> <tr><td>S_IRGRP</td> <td>文件模式指示群组可读。</td></tr> <tr><td>S_IWGRP</td> <td>文件模式指示群组可写。</td></tr> <tr><td>S_IXGRP</td> <td>文件模式指示群组可执行。</td></tr> <tr><td>S_IRWXO</td> <td>文件模式指示其他人可读、可写和可执行。</td></tr> <tr><td>S_IROTH</td> <td>文件模式指示其他人可读。</td></tr> <tr><td>S_IWOTH</td> <td>文件模式指示其他人可写。</td></tr> <tr><td>S_IXOTH</td> <td>文件模式指示其他人可执行。</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog-vuepress/book-web/web后端/学习node.js/2.Buffer缓存区和path路径.html" class="prev">
        2.Buffer缓存区和path路径
      </a></span> <span class="next"><a href="/blog-vuepress/book-web/web后端/学习node.js/4.http传输相关.html">
        4.http传输相关
      </a>
      →
    </span></p></div> </main> <div class="right-sidebar-wrapper right-sidebar-hidden"><aside class="right-sidebar"><div><div class="title">本文目录</div><h1><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#文件和目录操作" title="文件和目录操作">文件和目录操作</a></h1><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#什么是-fs-文件系统模块" title="什么是 fs 文件系统模块">什么是 fs 文件系统模块</a></h2><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#文件操作" title="文件操作">文件操作</a></h2><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#fs-open" title="fs.open()">fs.open()</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#fs-close" title="fs.close()">fs.close()</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#fs-read" title="fs.read()">fs.read()</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#fs-readfile" title="fs.readFile()">fs.readFile()</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#fs-write" title="fs.write()">fs.write()</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#fs-writefile" title="fs.writeFile()">fs.writeFile()</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#fs-stat" title="fs.stat()">fs.stat()</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#fs-access" title="fs.access()">fs.access()</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#fs-appendfile" title="fs.appendFile()">fs.appendFile()</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#fs-createreadstream" title="fs.createReadStream()">fs.createReadStream()</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#fs-createwritestream" title="fs.createWriteStream()">fs.createWriteStream()</a></h3><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#文件的模式" title="文件的模式">文件的模式</a></h2><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#文件系统标志" title="文件系统标志">文件系统标志</a></h2><h2><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#fs-常量" title="FS 常量">FS 常量</a></h2><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#文件访问的常量" title="文件访问的常量">文件访问的常量</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#文件复制的常量" title="文件复制的常量">文件复制的常量</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#文件打开的常量" title="文件打开的常量">文件打开的常量</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#文件类型的常量" title="文件类型的常量">文件类型的常量</a></h3><h3><a href="/blog-vuepress/book-web/web%E5%90%8E%E7%AB%AF/%E5%AD%A6%E4%B9%A0node.js/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.html#文件模式的常量" title="文件模式的常量">文件模式的常量</a></h3></div></aside> <div class="sidebar-toggle" data-v-10bfdc0c><div class="sidebar-toggle-button" data-v-10bfdc0c><span data-v-10bfdc0c></span><span data-v-10bfdc0c></span><span data-v-10bfdc0c></span></div></div></div></div><div class="global-ui"><!----></div></div>
    <script src="/blog-vuepress/assets/js/app.34680ebc.js" defer></script><script src="/blog-vuepress/assets/js/2.1e7adb41.js" defer></script><script src="/blog-vuepress/assets/js/100.311567ba.js" defer></script><script src="/blog-vuepress/assets/js/38.cec9a03e.js" defer></script>
  </body>
</html>
